(()=>{"use strict";var e,t={427:(e,t)=>{Object.prototype.toString},665:(e,t,n)=>{var r={};n.r(r),n.d(r,{hasBrowserEnv:()=>An,hasStandardBrowserEnv:()=>Pn,hasStandardBrowserWebWorkerEnv:()=>Ln,navigator:()=>Fn,origin:()=>Dn});const a=window.wp.element,o=window.React;var s=n.n(o),i=(n(427),"popstate");function l(e={}){return function(e,t,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,s=a.history,l="POP",u=null,f=p();function p(){return(s.state||{idx:null}).idx}function g(){l="POP";let e=p(),t=null==e?null:e-f;f=e,u&&u({action:l,location:b.location,delta:t})}function y(e){return function(e,t=!1){let n="http://localhost";"undefined"!=typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),c(n,"No window.location.(origin|href) available to create URL");let r="string"==typeof e?e:m(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}(e)}null==f&&(f=0,s.replaceState({...s.state,idx:f},""));let b={get action(){return l},get location(){return e(a,s)},listen(e){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(i,g),u=e,()=>{a.removeEventListener(i,g),u=null}},createHref:e=>t(a,e),createURL:y,encodeLocation(e){let t=y(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let r=h(b.location,e,t);n&&n(r,e),f=p()+1;let i=d(r,f),c=b.createHref(r);try{s.pushState(i,"",c)}catch(e){if(e instanceof DOMException&&"DataCloneError"===e.name)throw e;a.location.assign(c)}o&&u&&u({action:l,location:b.location,delta:1})},replace:function(e,t){l="REPLACE";let r=h(b.location,e,t);n&&n(r,e),f=p();let a=d(r,f),i=b.createHref(r);s.replaceState(a,"",i),o&&u&&u({action:l,location:b.location,delta:0})},go:e=>s.go(e)};return b}((function(e,t){let{pathname:n,search:r,hash:a}=e.location;return h("",{pathname:n,search:r,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"==typeof t?t:m(t)}),null,e)}function c(e,t){if(!1===e||null==e)throw new Error(t)}function u(e,t){if(!e){"undefined"!=typeof console&&console.warn(t);try{throw new Error(t)}catch(e){}}}function d(e,t){return{usr:e.state,key:e.key,idx:t}}function h(e,t,n=null,r){return{pathname:"string"==typeof e?e:e.pathname,search:"",hash:"",..."string"==typeof t?f(t):t,state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)}}function m({pathname:e="/",search:t="",hash:n=""}){return t&&"?"!==t&&(e+="?"===t.charAt(0)?t:"?"+t),n&&"#"!==n&&(e+="#"===n.charAt(0)?n:"#"+n),e}function f(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function p(e,t,n="/"){return function(e,t,n,r){let a=_(("string"==typeof t?f(t):t).pathname||"/",n);if(null==a)return null;let o=g(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){return e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]))?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(o);let s=null;for(let e=0;null==s&&e<o.length;++e){let t=C(a);s=R(o[e],t,r)}return s}(e,t,n,!1)}function g(e,t=[],n=[],r=""){let a=(e,a,o)=>{let s={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};s.relativePath.startsWith("/")&&(c(s.relativePath.startsWith(r),`Absolute route path "${s.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),s.relativePath=s.relativePath.slice(r.length));let i=F([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(c(!0!==e.index,`Index routes must not have child routes. Please remove all child routes from route path "${i}".`),g(e.children,t,l,i)),(null!=e.path||e.index)&&t.push({path:i,score:E(i,e.index),routesMeta:l})};return e.forEach(((e,t)=>{if(""!==e.path&&e.path?.includes("?"))for(let n of y(e.path))a(e,t,n);else a(e,t)})),t}function y(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===r.length)return a?[o,""]:[o];let s=y(r.join("/")),i=[];return i.push(...s.map((e=>""===e?o:[o,e].join("/")))),a&&i.push(...s),i.map((t=>e.startsWith("/")&&""===t?"/":t))}new WeakMap;var b=/^:[\w-]+$/,v=3,w=2,x=1,j=10,S=-2,N=e=>"*"===e;function E(e,t){let n=e.split("/"),r=n.length;return n.some(N)&&(r+=S),t&&(r+=w),n.filter((e=>!N(e))).reduce(((e,t)=>e+(b.test(t)?v:""===t?x:j)),r)}function R(e,t,n=!1){let{routesMeta:r}=e,a={},o="/",s=[];for(let e=0;e<r.length;++e){let i=r[e],l=e===r.length-1,c="/"===o?t:t.slice(o.length)||"/",u=k({path:i.relativePath,caseSensitive:i.caseSensitive,end:l},c),d=i.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=k({path:i.relativePath,caseSensitive:i.caseSensitive,end:!1},c)),!u)return null;Object.assign(a,u.params),s.push({params:a,pathname:F([o,u.pathname]),pathnameBase:P(F([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=F([o,u.pathnameBase]))}return s}function k(e,t){"string"==typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t=!1,n=!0){u("*"===e||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));return e.endsWith("*")?(r.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],s=o.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:r.reduce(((e,{paramName:t,isOptional:n},r)=>{if("*"===t){let e=i[r]||"";s=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const a=i[r];return e[t]=n&&!a?void 0:(a||"").replace(/%2F/g,"/"),e}),{}),pathname:o,pathnameBase:s,pattern:e}}function C(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return u(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function _(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function O(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function T(e){let t=function(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}(e);return t.map(((e,n)=>n===t.length-1?e.pathname:e.pathnameBase))}function A(e,t,n,r=!1){let a;"string"==typeof e?a=f(e):(a={...e},c(!a.pathname||!a.pathname.includes("?"),O("?","pathname","search",a)),c(!a.pathname||!a.pathname.includes("#"),O("#","pathname","hash",a)),c(!a.search||!a.search.includes("#"),O("#","search","hash",a)));let o,s=""===e||""===a.pathname,i=s?"/":a.pathname;if(null==i)o=n;else{let e=t.length-1;if(!r&&i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;a.pathname=t.join("/")}o=e>=0?t[e]:"/"}let l=function(e,t="/"){let{pathname:n,search:r="",hash:a=""}="string"==typeof e?f(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:L(r),hash:D(a)}}(a,o),u=i&&"/"!==i&&i.endsWith("/"),d=(s||"."===i)&&n.endsWith("/");return l.pathname.endsWith("/")||!u&&!d||(l.pathname+="/"),l}var F=e=>e.join("/").replace(/\/\/+/g,"/"),P=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),L=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",D=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function U(e){return null!=e&&"number"==typeof e.status&&"string"==typeof e.statusText&&"boolean"==typeof e.internal&&"data"in e}var B=["POST","PUT","PATCH","DELETE"],I=(new Set(B),["GET",...B]);new Set(I),Symbol("ResetLoaderData");var $=o.createContext(null);$.displayName="DataRouter";var M=o.createContext(null);M.displayName="DataRouterState";var W=o.createContext({isTransitioning:!1});W.displayName="ViewTransition",o.createContext(new Map).displayName="Fetchers",o.createContext(null).displayName="Await";var J=o.createContext(null);J.displayName="Navigation";var q=o.createContext(null);q.displayName="Location";var H=o.createContext({outlet:null,matches:[],isDataRoute:!1});H.displayName="Route";var z=o.createContext(null);function V(){return null!=o.useContext(q)}function G(){return c(V(),"useLocation() may be used only in the context of a <Router> component."),o.useContext(q).location}z.displayName="RouteError";var K="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y(e){o.useContext(J).static||o.useLayoutEffect(e)}function X(){let{isDataRoute:e}=o.useContext(H);return e?function(){let{router:e}=function(e){let t=o.useContext($);return c(t,ae(e)),t}("useNavigate"),t=oe("useNavigate"),n=o.useRef(!1);return Y((()=>{n.current=!0})),o.useCallback((async(r,a={})=>{u(n.current,K),n.current&&("number"==typeof r?e.navigate(r):await e.navigate(r,{fromRouteId:t,...a}))}),[e,t])}():function(){c(V(),"useNavigate() may be used only in the context of a <Router> component.");let e=o.useContext($),{basename:t,navigator:n}=o.useContext(J),{matches:r}=o.useContext(H),{pathname:a}=G(),s=JSON.stringify(T(r)),i=o.useRef(!1);return Y((()=>{i.current=!0})),o.useCallback(((r,o={})=>{if(u(i.current,K),!i.current)return;if("number"==typeof r)return void n.go(r);let l=A(r,JSON.parse(s),a,"path"===o.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:F([t,l.pathname])),(o.replace?n.replace:n.push)(l,o.state,o)}),[t,n,s,a,e])}()}function Q(e,{relative:t}={}){let{matches:n}=o.useContext(H),{pathname:r}=G(),a=JSON.stringify(T(n));return o.useMemo((()=>A(e,JSON.parse(a),r,"path"===t)),[e,a,r,t])}function Z(e,t,n,r){c(V(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=o.useContext(J),{matches:s}=o.useContext(H),i=s[s.length-1],l=i?i.params:{},d=i?i.pathname:"/",h=i?i.pathnameBase:"/",m=i&&i.route;{let e=m&&m.path||"";ie(d,!m||e.endsWith("*")||e.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="${e}"> to <Route path="${"/"===e?"*":`${e}/*`}">.`)}let g,y=G();if(t){let e="string"==typeof t?f(t):t;c("/"===h||e.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${e.pathname}" was given in the \`location\` prop.`),g=e}else g=y;let b=g.pathname||"/",v=b;if("/"!==h){let e=h.replace(/^\//,"").split("/");v="/"+b.replace(/^\//,"").split("/").slice(e.length).join("/")}let w=p(e,{pathname:v});u(m||null!=w,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),u(null==w||void 0!==w[w.length-1].route.element||void 0!==w[w.length-1].route.Component||void 0!==w[w.length-1].route.lazy,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=function(e,t=[],n=null){if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,a=n?.errors;if(null!=a){let e=r.findIndex((e=>e.route.id&&void 0!==a?.[e.route.id]));c(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),r=r.slice(0,Math.min(r.length,e+1))}let s=!1,i=-1;if(n)for(let e=0;e<r.length;e++){let t=r[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(i=e),t.route.id){let{loaderData:e,errors:a}=n,o=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!a||void 0===a[t.route.id]);if(t.route.lazy||o){s=!0,r=i>=0?r.slice(0,i+1):[r[0]];break}}}return r.reduceRight(((e,l,c)=>{let u,d=!1,h=null,m=null;n&&(u=a&&l.route.id?a[l.route.id]:void 0,h=l.route.errorElement||te,s&&(i<0&&0===c?(ie("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,m=null):i===c&&(d=!0,m=l.route.hydrateFallbackElement||null)));let f=t.concat(r.slice(0,c+1)),p=()=>{let t;return t=u?h:d?m:l.route.Component?o.createElement(l.route.Component,null):l.route.element?l.route.element:e,o.createElement(re,{match:l,routeContext:{outlet:e,matches:f,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===c)?o.createElement(ne,{location:n.location,revalidation:n.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):p()}),null)}(w&&w.map((e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:F([h,a.encodeLocation?a.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:F([h,a.encodeLocation?a.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),s,n,r);return t&&x?o.createElement(q.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},x):x}function ee(){let e=function(){let e=o.useContext(z),t=function(e){let t=o.useContext(M);return c(t,ae(e)),t}("useRouteError"),n=oe("useRouteError");return void 0!==e?e:t.errors?.[n]}(),t=U(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},i=null;return console.error("Error handled by React Router default ErrorBoundary:",e),i=o.createElement(o.Fragment,null,o.createElement("p",null,"💿 Hey developer 👋"),o.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",o.createElement("code",{style:s},"ErrorBoundary")," or"," ",o.createElement("code",{style:s},"errorElement")," prop on your route.")),o.createElement(o.Fragment,null,o.createElement("h2",null,"Unexpected Application Error!"),o.createElement("h3",{style:{fontStyle:"italic"}},t),n?o.createElement("pre",{style:a},n):null,i)}o.createContext(null);var te=o.createElement(ee,null),ne=class extends o.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?o.createElement(H.Provider,{value:this.props.routeContext},o.createElement(z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function re({routeContext:e,match:t,children:n}){let r=o.useContext($);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),o.createElement(H.Provider,{value:e},n)}function ae(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oe(e){let t=function(e){let t=o.useContext(H);return c(t,ae(e)),t}(e),n=t.matches[t.matches.length-1];return c(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}var se={};function ie(e,t,n){t||se[e]||(se[e]=!0,u(!1,n))}function le(e){c(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function ce({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:a,static:s=!1}){c(!V(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=e.replace(/^\/*/,"/"),l=o.useMemo((()=>({basename:i,navigator:a,static:s,future:{}})),[i,a,s]);"string"==typeof n&&(n=f(n));let{pathname:d="/",search:h="",hash:m="",state:p=null,key:g="default"}=n,y=o.useMemo((()=>{let e=_(d,i);return null==e?null:{location:{pathname:e,search:h,hash:m,state:p,key:g},navigationType:r}}),[i,d,h,m,p,g,r]);return u(null!=y,`<Router basename="${i}"> is not able to match the URL "${d}${h}${m}" because it does not start with the basename, so the <Router> won't render anything.`),null==y?null:o.createElement(J.Provider,{value:l},o.createElement(q.Provider,{children:t,value:y}))}function ue({children:e,location:t}){return Z(de(e),t)}function de(e,t=[]){let n=[];return o.Children.forEach(e,((e,r)=>{if(!o.isValidElement(e))return;let a=[...t,r];if(e.type===o.Fragment)return void n.push.apply(n,de(e.props.children,a));c(e.type===le,`[${"string"==typeof e.type?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),c(!e.props.index||!e.props.children,"An index route cannot have child routes.");let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=de(e.props.children,a)),n.push(s)})),n}o.memo((function({routes:e,future:t,state:n}){return Z(e,void 0,n,t)})),o.Component;var he="get",me="application/x-www-form-urlencoded";function fe(e){return null!=e&&"string"==typeof e.tagName}function pe(e=""){return new URLSearchParams("string"==typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce(((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map((e=>[n,e])):[[n,r]])}),[]))}var ge=null,ye=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function be(e){return null==e||ye.has(e)?e:(u(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${me}"`),null)}function ve(e,t){if(!1===e||null==e)throw new Error(t)}function we(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"==typeof e.imageSrcSet&&"string"==typeof e.imageSizes:"string"==typeof e.rel&&"string"==typeof e.href)}function xe(e,t,n,r,a,o){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,i=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith("*")&&n[t].params["*"]!==e.params["*"];return"assets"===o?t.filter(((e,t)=>s(e,t)||i(e,t))):"data"===o?t.filter(((t,o)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,o)||i(t,o))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"==typeof r)return r}return!0})):[]}function je(e,t,{includeHydrateFallback:n}={}){return r=e.map((e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a})).flat(1),[...new Set(r)];var r}Object.getOwnPropertyNames(Object.prototype).sort().join("\0"),"undefined"!=typeof window?window:"undefined"!=typeof globalThis&&globalThis,Symbol("SingleFetchRedirect");function Se(){let e=o.useContext($);return ve(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function Ne(){let e=o.useContext(M);return ve(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}o.Component;var Ee=o.createContext(void 0);function Re(){let e=o.useContext(Ee);return ve(e,"You must render this element inside a <HydratedRouter> element"),e}function ke(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Ce({page:e,...t}){let{router:n}=Se(),r=o.useMemo((()=>p(n.routes,e,n.basename)),[n.routes,e,n.basename]);return r?o.createElement(Oe,{page:e,matches:r,...t}):null}function _e(e){let{manifest:t,routeModules:n}=Re(),[r,a]=o.useState([]);return o.useEffect((()=>{let r=!1;return async function(e,t,n){return function(e,t){let n=new Set,r=new Set(t);return e.reduce(((e,a)=>{if(t&&(null==(o=a)||"string"!=typeof o.page)&&"script"===a.as&&a.href&&r.has(a.href))return e;var o;let s=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(a));return n.has(s)||(n.add(s),e.push({key:s,link:a})),e}),[])}((await Promise.all(e.map((async e=>{let r=t.routes[e.route.id];if(r){let e=await async function(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise((()=>{}))}}(r,n);return e.links?e.links():[]}return[]})))).flat(1).filter(we).filter((e=>"stylesheet"===e.rel||"preload"===e.rel)).map((e=>"stylesheet"===e.rel?{...e,rel:"prefetch",as:"style"}:{...e,rel:"prefetch"})))}(e,t,n).then((e=>{r||a(e)})),()=>{r=!0}}),[e,t,n]),r}function Oe({page:e,matches:t,...n}){let r=G(),{manifest:a,routeModules:s}=Re(),{basename:i}=Se(),{loaderData:l,matches:c}=Ne(),u=o.useMemo((()=>xe(e,t,c,a,r,"data")),[e,t,c,a,r]),d=o.useMemo((()=>xe(e,t,c,a,r,"assets")),[e,t,c,a,r]),h=o.useMemo((()=>{if(e===r.pathname+r.search+r.hash)return[];let n=new Set,o=!1;if(t.forEach((e=>{let t=a.routes[e.route.id];t&&t.hasLoader&&(!u.some((t=>t.route.id===e.route.id))&&e.route.id in l&&s[e.route.id]?.shouldRevalidate||t.hasClientLoader?o=!0:n.add(e.route.id))})),0===n.size)return[];let c=function(e,t){let n="string"==typeof e?new URL(e,"undefined"==typeof window?"server://singlefetch/":window.location.origin):e;return"/"===n.pathname?n.pathname="_root.data":t&&"/"===_(n.pathname,t)?n.pathname=`${t.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}(e,i);return o&&n.size>0&&c.searchParams.set("_routes",t.filter((e=>n.has(e.route.id))).map((e=>e.route.id)).join(",")),[c.pathname+c.search]}),[i,l,r,a,u,t,e,s]),m=o.useMemo((()=>je(d,a)),[d,a]),f=_e(d);return o.createElement(o.Fragment,null,h.map((e=>o.createElement("link",{key:e,rel:"prefetch",as:"fetch",href:e,...n}))),m.map((e=>o.createElement("link",{key:e,rel:"modulepreload",href:e,...n}))),f.map((({key:e,link:t})=>o.createElement("link",{key:e,...t}))))}Ee.displayName="FrameworkContext";function Te(...e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)}))}}var Ae="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;try{Ae&&(window.__reactRouterVersion="7.6.2")}catch(e){}function Fe({basename:e,children:t,window:n}){let r=o.useRef();null==r.current&&(r.current=l({window:n,v5Compat:!0}));let a=r.current,[s,i]=o.useState({action:a.action,location:a.location}),c=o.useCallback((e=>{o.startTransition((()=>i(e)))}),[i]);return o.useLayoutEffect((()=>a.listen(c)),[a,c]),o.createElement(ce,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:a})}var Pe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Le=o.forwardRef((function({onClick:e,discover:t="render",prefetch:n="none",relative:r,reloadDocument:a,replace:s,state:i,target:l,to:d,preventScrollReset:h,viewTransition:f,...p},g){let y,{basename:b}=o.useContext(J),v="string"==typeof d&&Pe.test(d),w=!1;if("string"==typeof d&&v&&(y=d,Ae))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=_(t.pathname,b);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:w=!0}catch(e){u(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let x=function(e,{relative:t}={}){c(V(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=o.useContext(J),{hash:a,pathname:s,search:i}=Q(e,{relative:t}),l=s;return"/"!==n&&(l="/"===s?n:F([n,s])),r.createHref({pathname:l,search:i,hash:a})}(d,{relative:r}),[j,S,N]=function(e,t){let n=o.useContext(Ee),[r,a]=o.useState(!1),[s,i]=o.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,m=o.useRef(null);o.useEffect((()=>{if("render"===e&&i(!0),"viewport"===e){let e=new IntersectionObserver((e=>{e.forEach((e=>{i(e.isIntersecting)}))}),{threshold:.5});return m.current&&e.observe(m.current),()=>{e.disconnect()}}}),[e]),o.useEffect((()=>{if(r){let e=setTimeout((()=>{i(!0)}),100);return()=>{clearTimeout(e)}}}),[r]);let f=()=>{a(!0)},p=()=>{a(!1),i(!1)};return n?"intent"!==e?[s,m,{}]:[s,m,{onFocus:ke(l,f),onBlur:ke(c,p),onMouseEnter:ke(u,f),onMouseLeave:ke(d,p),onTouchStart:ke(h,f)}]:[!1,m,{}]}(n,p),E=function(e,{target:t,replace:n,state:r,preventScrollReset:a,relative:s,viewTransition:i}={}){let l=X(),c=G(),u=Q(e,{relative:s});return o.useCallback((o=>{if(function(e,t){return!(0!==e.button||t&&"_self"!==t||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e))}(o,t)){o.preventDefault();let t=void 0!==n?n:m(c)===m(u);l(e,{replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:i})}}),[c,l,u,n,r,t,e,a,s,i])}(d,{replace:s,state:i,target:l,preventScrollReset:h,relative:r,viewTransition:f}),R=o.createElement("a",{...p,...N,href:y||x,onClick:w||a?e:function(t){e&&e(t),t.defaultPrevented||E(t)},ref:Te(g,S),target:l,"data-discover":v||"render"!==t?void 0:"true"});return j&&!v?o.createElement(o.Fragment,null,R,o.createElement(Ce,{page:x})):R}));function De(e){let t=o.useContext($);return c(t,function(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}(e)),t}Le.displayName="Link",o.forwardRef((function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:r=!1,style:a,to:s,viewTransition:i,children:l,...u},d){let h=Q(s,{relative:u.relative}),m=G(),f=o.useContext(M),{navigator:p,basename:g}=o.useContext(J),y=null!=f&&function(e,t={}){let n=o.useContext(W);c(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=De("useViewTransitionState"),a=Q(e,{relative:t.relative});if(!n.isTransitioning)return!1;let s=_(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=_(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=k(a.pathname,i)||null!=k(a.pathname,s)}(h)&&!0===i,b=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,v=m.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(v=v.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&g&&(w=_(w,g)||w);const x="/"!==b&&b.endsWith("/")?b.length-1:b.length;let j,S=v===b||!r&&v.startsWith(b)&&"/"===v.charAt(x),N=null!=w&&(w===b||!r&&w.startsWith(b)&&"/"===w.charAt(b.length)),E={isActive:S,isPending:N,isTransitioning:y},R=S?e:void 0;j="function"==typeof n?n(E):[n,S?"active":null,N?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C="function"==typeof a?a(E):a;return o.createElement(Le,{...u,"aria-current":R,className:j,ref:d,style:C,to:s,viewTransition:i},"function"==typeof l?l(E):l)})).displayName="NavLink",o.forwardRef((({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:a,state:s,method:i=he,action:l,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:f,...p},g)=>{let y=function(){let{router:e}=De("useSubmit"),{basename:t}=o.useContext(J),n=oe("useRouteId");return o.useCallback((async(r,a={})=>{let{action:o,method:s,encType:i,formData:l,body:c}=function(e,t){let n,r,a,o,s;if(fe(i=e)&&"form"===i.tagName.toLowerCase()){let s=e.getAttribute("action");r=s?_(s,t):null,n=e.getAttribute("method")||he,a=be(e.getAttribute("enctype"))||me,o=new FormData(e)}else if(function(e){return fe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return fe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let i=e.getAttribute("formaction")||s.getAttribute("action");if(r=i?_(i,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||he,a=be(e.getAttribute("formenctype"))||be(s.getAttribute("enctype"))||me,o=new FormData(s,e),!function(){if(null===ge)try{new FormData(document.createElement("form"),0),ge=!1}catch(e){ge=!0}return ge}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?`${t}.`:"";o.append(`${e}x`,"0"),o.append(`${e}y`,"0")}else t&&o.append(t,r)}}else{if(fe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=he,r=null,a=me,s=e}var i;return o&&"text/plain"===a&&(s=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:s}}(r,t);if(!1===a.navigate){let t=a.fetcherKey||Ie();await e.fetch(t,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||i,flushSync:a.flushSync})}else await e.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})}),[e,t,n])}(),b=function(e,{relative:t}={}){let{basename:n}=o.useContext(J),r=o.useContext(H);c(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...Q(e||".",{relative:t})},i=G();if(null==e){s.search=i.search;let e=new URLSearchParams(s.search),t=e.getAll("index");if(t.some((e=>""===e))){e.delete("index"),t.filter((e=>e)).forEach((t=>e.append("index",t)));let n=e.toString();s.search=n?`?${n}`:""}}return e&&"."!==e||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),"/"!==n&&(s.pathname="/"===s.pathname?n:F([n,s.pathname])),m(s)}(l,{relative:d}),v="get"===i.toLowerCase()?"get":"post",w="string"==typeof l&&Pe.test(l);return o.createElement("form",{ref:g,method:v,action:b,onSubmit:r?u:e=>{if(u&&u(e),e.defaultPrevented)return;e.preventDefault();let r=e.nativeEvent.submitter,o=r?.getAttribute("formmethod")||i;y(r||e.currentTarget,{fetcherKey:t,method:o,navigate:n,replace:a,state:s,relative:d,preventScrollReset:h,viewTransition:f})},...p,"data-discover":w||"render"!==e?void 0:"true"})})).displayName="Form";var Ue,Be=0,Ie=()=>`__${String(++Be)}__`;const $e="__bee_error_bus__",Me=globalThis,We=null!==(Ue=Me[$e])&&void 0!==Ue?Ue:Me[$e]=function(){const e=new Set;return{on:t=>(e.add(t),()=>e.delete(t)),emit(t){for(const n of Array.from(e))n(t)},clear(){e.clear()}}}(),Je=window.ReactJSXRuntime,qe=(0,o.createContext)(null),He=({children:e,errorPath:t="/error"})=>{var n;const[r,a]=(0,o.useState)((()=>{try{const e=sessionStorage.getItem("bee_errors");return e?JSON.parse(e):[]}catch{return[]}})),s=null!==(n=r.at(-1))&&void 0!==n?n:null,i=X(),l=G(),c=(0,o.useRef)();(0,o.useEffect)((()=>(c.current=We.on((e=>{a((t=>{const n=[...t,e];try{sessionStorage.setItem("bee_errors",JSON.stringify(n.slice(-20)))}catch{}return n}));const n="page"===e.severity||e.httpStatus&&e.httpStatus>=400,r=l.pathname===t;n&&!r&&setTimeout((()=>i(t)),0)})),()=>c.current?.())),[i,l.pathname,t]);const u=()=>{a([]);try{sessionStorage.removeItem("bee_errors")}catch{}},d=()=>{a((e=>e.slice(0,-1)));try{const e=r.slice(0,-1);sessionStorage.setItem("bee_errors",JSON.stringify(e))}catch{}},h=(0,o.useMemo)((()=>({last:s,stack:r,clear:u,dismissLast:d})),[s,r]);return(0,Je.jsx)(qe.Provider,{value:h,children:e})},ze=()=>{const e=(0,o.useContext)(qe);if(!e)throw new Error("useErrors must be used inside ErrorProvider");return e};function Ve(e){var t;if("network"===e.category)return"Network error – check your connection and try again.";if("rate_limit"===e.category)return"You’re doing that too often. Please wait a moment and try again.";if("auth"===e.category)return"Please sign in to continue.";if("not_found"===e.category)return"We couldn’t find what you were looking for.";if("server"===e.category)return"The server encountered a problem.";switch(e.httpStatus){case 400:return"There’s a problem with your request.";case 401:return"Please sign in to continue.";case 403:return"You don’t have permission to perform this action.";case 404:return"The requested resource was not found.";default:return(null!==(t=e.httpStatus)&&void 0!==t?t:0)>=500?"The server encountered a problem.":e.message||"Something went wrong."}}const Ge=()=>{const{last:e,stack:t,dismissLast:n}=ze(),r=(0,o.useMemo)((()=>e&&"page"!==e.severity&&"silent"!==e.severity?t.slice(-3).every((t=>t.message===e.message&&t.httpStatus===e.httpStatus))?null:e:null),[e,t]);return(0,o.useEffect)((()=>{if(!r||"toast"!==r.severity)return;const e=setTimeout((()=>n()),r.retryable?8e3:6e3);return()=>clearTimeout(e)}),[r,n]),r?(0,Je.jsxs)("div",{className:"alert alert-warning m-2 py-2 d-flex align-items-start",role:"status","aria-live":"polite",children:[(0,Je.jsxs)("div",{children:[r.httpStatus?(0,Je.jsx)("strong",{children:r.httpStatus}):null," ",Ve(r),r.user&&(0,Je.jsxs)("div",{className:"small text-muted mt-1",children:[r.user.isLoggedIn?"Logged in":"Guest",r.user.username?` • ${r.user.username}`:"",Array.isArray(r.user.roles)&&r.user.roles.length?` • ${r.user.roles.join(", ")}`:""]}),r.retryable&&(0,Je.jsx)("button",{className:"btn btn-sm btn-outline-dark ms-2",onClick:()=>location.reload(),children:"Retry"})]}),(0,Je.jsx)("button",{className:"btn btn-sm btn-link ms-auto text-dark text-decoration-none","aria-label":"Dismiss",onClick:n,style:{lineHeight:1},children:"✕"})]}):null};let Ke=null;function Ye(){try{return Ke?.()||void 0}catch{return}}let Xe=0;function Qe(e,t={}){var n,r,a,o,s,i,l;const c=e,u=c?.response?.status,d=c?.response?.data,h=null!==(n=null!==(r=null!==(a=null!==(o=d?.detail)&&void 0!==o?o:d?.message)&&void 0!==a?a:c?.message)&&void 0!==r?r:e?.message)&&void 0!==n?n:"Unknown error",m=null!==(s=null!==(i=d?.code)&&void 0!==i?i:d?.error)&&void 0!==s?s:c?.code,f=c?.config?.method?.toUpperCase(),p=c?.config?.url,g=c?.config?.data,y=d?.data?.status&&Number(d.data.status)||void 0,b=null!=u?u:y,v="undefined"!=typeof navigator&&!1===navigator.onLine,w=c&&!c.response||"ECONNABORTED"===m||v;let x="unknown";w?x="network":401===b||403===b?x="auth":404===b?x="not_found":429===b?x="rate_limit":b&&b>=500&&(x="server");let j=b&&b>=500||401===b||403===b?"page":"toast";const S=w||429===b||b&&b>=500;return{id:`E${Date.now()}_${++Xe}`,message:h,code:m,httpStatus:b,severity:j,request:{method:f,url:p,payload:g},ts:Date.now(),raw:e,category:x,retryable:S,...t,user:null!==(l=t.user)&&void 0!==l?l:Ye()}}class Ze extends s().Component{state={hasError:!1};static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){const n=Qe(e,{component:"ErrorBoundary",functionName:"componentDidCatch"});We.emit(n)}render(){return this.state.hasError?(0,Je.jsxs)("div",{className:"container py-4",children:[(0,Je.jsx)("h2",{children:"Something went wrong."}),(0,Je.jsx)("p",{className:"text-muted",children:"We’re redirecting you to the error page…"})]}):this.props.children}}const et=()=>{const{stack:e,clear:t}=ze(),{state:n}=G(),r=X(),a=(0,o.useMemo)((()=>{var t;return n?.errorId&&null!==(t=e.find((e=>e.id===n.errorId)))&&void 0!==t?t:e.at(-1)}),[e,n]);return a?(0,Je.jsxs)("div",{className:"container py-4",children:[(0,Je.jsx)("h2",{children:"⚠️ An error occurred"}),(0,Je.jsx)("p",{className:"text-muted",children:Ve(a)}),(0,Je.jsx)("div",{className:"card my-3",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Message:"})," ",a.message]}),a.code&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Code:"})," ",a.code]}),void 0!==a.httpStatus&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Status:"})," ",a.httpStatus]}),a.request?.method&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Request:"})," ",a.request.method," ",a.request.url]}),a.component&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Component:"})," ",a.component]}),a.functionName&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Function:"})," ",a.functionName]}),a.route&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Route:"})," ",a.route]}),a.service&&(0,Je.jsxs)("div",{children:[(0,Je.jsx)("strong",{children:"Service:"})," ",a.service]}),(0,Je.jsxs)("div",{className:"small text-muted mt-2",children:["Error ID: ",a.id]})]})}),(0,Je.jsxs)("div",{className:"d-flex gap-2",children:[(0,Je.jsx)("button",{className:"btn btn-primary",onClick:()=>r("/dashboard"),children:"Back to dashboard"}),(0,Je.jsx)("button",{className:"btn btn-outline-secondary",onClick:()=>{t(),r(-1)},children:"Go back"}),(401===a.httpStatus||403===a.httpStatus)&&(0,Je.jsx)("button",{className:"btn btn-outline-danger",onClick:()=>r("/login"),children:"Sign in"})]}),a.user&&(0,Je.jsxs)("section",{className:"mt-3",children:[(0,Je.jsx)("h3",{children:"User"}),(0,Je.jsxs)("ul",{children:[(0,Je.jsxs)("li",{children:["Status: ",a.user.isLoggedIn?"Logged in":"Guest"]}),void 0!==a.user.id&&(0,Je.jsxs)("li",{children:["ID: ",String(a.user.id)]}),a.user.username&&(0,Je.jsxs)("li",{children:["Username: ",a.user.username]}),a.user.email&&(0,Je.jsxs)("li",{children:["Email: ",a.user.email]}),a.user.roles?.length?(0,Je.jsxs)("li",{children:["Roles: ",a.user.roles.join(", ")]}):null]})]})]}):(0,Je.jsx)("div",{className:"container py-4",children:(0,Je.jsx)("h2",{children:"All good 🎉"})})};function tt({apiApp:e,apiUser:t,plugin:n,paths:r}){var a,o;const s=null!==(a=r?.missing)&&void 0!==a?a:"/definitely_missing_endpoint",i=null!==(o=r?.slow)&&void 0!==o?o:"/slow";return(0,Je.jsxs)("div",{className:"d-flex gap-2 my-3",children:[(0,Je.jsx)("button",{className:"btn btn-outline-secondary",onClick:async function(){try{await e.get(s)}catch(e){console.warn("404 test caught",e)}},children:"Trigger 404"}),(0,Je.jsx)("button",{className:"btn btn-outline-secondary",onClick:async function(){try{await t.get(i,{timeout:1})}catch(e){console.warn("timeout test caught",e)}},children:"Trigger timeout"}),(0,Je.jsx)("button",{className:"btn btn-outline-secondary",onClick:function(){const e=Qe(new Error("Manual test error"),{code:"MANUAL_TEST",severity:"toast",category:"unknown",service:"ui",functionName:"emitManual",meta:n?{plugin:n}:void 0});We.emit(e)},children:"Emit manual AppError"})]})}const nt="bee:errorHistory:v1";let rt=[],at=new Set,ot=!1;function st(){if("undefined"!=typeof window)try{window.localStorage.setItem(nt,JSON.stringify(rt))}catch{}}function it(){for(const e of at)e([...rt])}function lt(){ot||(ot=!0,function(){if("undefined"!=typeof window)try{const e=window.localStorage.getItem(nt);e&&(rt=JSON.parse(e))}catch{}}(),We.on?.((e=>{const t={id:e?.id||`err_${Date.now()}_${Math.random().toString(36).slice(2)}`,ts:Date.now(),code:e?.code,message:e?.message||"Unknown error",severity:e?.severity,category:e?.category,service:e?.service,functionName:e?.functionName,meta:e?.meta};rt.push(t),rt.length>500&&(rt=rt.slice(-500)),st(),it()})))}function ct(e){try{return new Date(e).toLocaleString()}catch{return String(e)}}function ut({plugin:e,limit:t}){const n=function(e){lt();const t=()=>{let t=[...rt].sort(((e,t)=>t.ts-e.ts));return e?.plugin&&(t=t.filter((t=>{const n=t.meta?.plugin||t.meta?.app||t.meta?.source||t.service;return String(n||"").toLowerCase()===e.plugin.toLowerCase()}))),e?.limit&&(t=t.slice(0,e.limit)),t},[n,r]=(0,o.useState)(t());return(0,o.useEffect)((()=>{const e=()=>r(t());return at.add(e),r(t()),()=>{at.delete(e)}}),[e?.plugin,e?.limit]),n}({plugin:e,limit:t});return(0,Je.jsxs)("section",{className:"bee-error-history",children:[(0,Je.jsxs)("div",{className:"toolbar",style:{display:"flex",gap:8,alignItems:"center",margin:"8px 0"},children:[(0,Je.jsxs)("strong",{children:["Error history",e?` (${e})`:""]}),(0,Je.jsx)("button",{className:"btn btn-sm btn-outline-danger",onClick:()=>(lt(),rt=[],st(),void it()),children:"Clear all"})]}),0===n.length?(0,Je.jsx)("div",{className:"text-muted",children:"No errors recorded yet."}):(0,Je.jsx)("div",{className:"table-responsive",children:(0,Je.jsxs)("table",{className:"table table-sm table-striped",children:[(0,Je.jsx)("thead",{children:(0,Je.jsxs)("tr",{children:[(0,Je.jsx)("th",{style:{whiteSpace:"nowrap"},children:"When"}),(0,Je.jsx)("th",{children:"Message"}),(0,Je.jsx)("th",{children:"Code"}),(0,Je.jsx)("th",{children:"Severity"}),(0,Je.jsx)("th",{children:"Category"}),(0,Je.jsx)("th",{children:"Service"}),(0,Je.jsx)("th",{style:{whiteSpace:"nowrap"},children:"Function"}),(0,Je.jsx)("th",{style:{width:1}})]})}),(0,Je.jsx)("tbody",{children:n.map((e=>{var t;return(0,Je.jsxs)("tr",{children:[(0,Je.jsx)("td",{style:{whiteSpace:"nowrap"},children:ct(e.ts)}),(0,Je.jsx)("td",{title:e.message,children:null!==(t=Ve?.(e))&&void 0!==t?t:e.message}),(0,Je.jsx)("td",{children:e.code||""}),(0,Je.jsx)("td",{children:e.severity||""}),(0,Je.jsx)("td",{children:e.category||""}),(0,Je.jsx)("td",{children:e.service||""}),(0,Je.jsx)("td",{style:{whiteSpace:"nowrap"},children:e.functionName||""}),(0,Je.jsx)("td",{style:{textAlign:"right"},children:(0,Je.jsx)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{return t=e.id,lt(),rt=rt.filter((e=>e.id!==t)),st(),void it();var t},children:"✖"})})]},e.id)}))})]})})]})}function dt(){return window.__bee_gt_state__||(window.__bee_gt_state__={loaded:!1,loading:!1,pending:[]}),window.__bee_gt_state__}function ht(){const e=dt();if(e.loaded||e.loading)return;e.loading=!0;const t="google-translate-script";if(!document.getElementById(t)){const e=document.createElement("script");e.id=t,e.src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit",document.body.appendChild(e)}window.googleTranslateElementInit=()=>{e.loaded=!0,e.loading=!1;for(const t of e.pending)mt(t.containerId,t.config);e.pending=[]}}function mt(e,t){if(!document.getElementById(e))return;const n=window.google?.translate?.TranslateElement;if(!n)return dt().pending.push({containerId:e,config:t}),void ht();new n(t,e)}const ft=({containerId:e="bee_gt_"+Math.random().toString(36).slice(2,8),languages:t="fr,en",pageLanguage:n="en",className:r="translate-box",style:a,label:s=(0,Je.jsx)(Je.Fragment,{children:"🌐 Translate: "})})=>((0,o.useEffect)((()=>{const r={pageLanguage:n,includedLanguages:t,autoDisplay:!1,default:t.split(",")[0]};window.__bee_gt_state__?.loaded&&window.google?.translate?.TranslateElement?mt(e,r):(dt().pending.push({containerId:e,config:r}),ht())}),[e,t,n]),(0,Je.jsxs)("div",{className:r,style:a,children:[s,(0,Je.jsx)("span",{id:e})]}));class pt extends Error{}function gt(e){if(!e)return!0;try{const t=function(e,t){if("string"!=typeof e)throw new pt("Invalid token specified: must be a string");t||(t={});const n=!0===t.header?0:1,r=e.split(".")[n];if("string"!=typeof r)throw new pt(`Invalid token specified: missing part #${n+1}`);let a;try{a=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return atob(t)}}(r)}catch(e){throw new pt(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(a)}catch(e){throw new pt(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}(e),n=Date.now()/1e3;return!t.exp||t.exp<n}catch(e){return console.error("Error decoding token:",e),!0}}pt.prototype.name="InvalidTokenError";const yt=(0,o.createContext)(void 0),bt=({children:e})=>{const[t,n]=(0,o.useState)(null),[r,a]=(0,o.useState)(null),s=!!t;return(0,o.useEffect)((()=>{console.log("[User] DEBUG token changed:",t)}),[t]),(0,o.useEffect)((()=>{console.log("[User] DEBUG user changed:",r)}),[r]),(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=localStorage.getItem("authToken"),t=localStorage.getItem("userInfo");e&&(gt(e)?localStorage.removeItem("authToken"):n(e)),t&&a(JSON.parse(t))}),[]),(0,o.useEffect)((()=>{if(!t)return;if(gt(t))return void n(null);const e=setInterval((()=>{n((e=>e&&gt(e)?null:e))}),3e4);return()=>clearInterval(e)}),[t]),(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=e=>{if("authToken"===e.key){const t=e.newValue;!t||gt(t)?n(null):n(t)}"userInfo"===e.key&&a(e.newValue?JSON.parse(e.newValue):null)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)}),[]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&(t?localStorage.setItem("authToken",t):localStorage.removeItem("authToken"))}),[t]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&(r?localStorage.setItem("userInfo",JSON.stringify(r)):localStorage.removeItem("userInfo"))}),[r]),(0,Je.jsx)(yt.Provider,{value:{token:t,user:r,isLoggedIn:s,login:(e,t)=>{n(e),a(t),console.log("[UserProvider] login called")},logout:()=>{n(null),a(null),"undefined"!=typeof window&&["authToken","userInfo"].forEach((e=>localStorage.removeItem(e))),console.log("[UserProvider] logout called")},setToken:e=>n(e)},children:e})},vt=()=>{const e=(0,o.useContext)(yt);if(!e)throw new Error("useUser must be used within UserProvider");return e},wt=()=>{const{user:e}=vt();return e?(0,Je.jsxs)("div",{className:"mb-3",children:[(0,Je.jsxs)("span",{children:["Welcome, ",(0,Je.jsxs)("strong",{children:[e.first_name," ",e.last_name]})]}),e.is_demo?(0,Je.jsxs)("span",{style:{marginLeft:8,padding:"2px 6px",borderRadius:6,background:"#ffeaa7"},children:["DEMO until ",(t=e.demo_expires_at,t?new Date(t).toLocaleString():"")]}):null]}):null;var t};function xt({mode:e="login",errorMessage:t,onSubmitLogin:n,onStartDemo:r,detectLang:a,initialRolesForDemo:s=["farmer"],getRandomDisplayName:i}){const[l,c]=(0,o.useState)(""),[u,d]=(0,o.useState)(""),[h,m]=(0,o.useState)(""),[f,p]=(0,o.useState)(""),g=(0,o.useMemo)((()=>[h,f].filter(Boolean).join(" ").trim()||void 0),[h,f]),y=(0,o.useCallback)((()=>{if(a)return a();const e=(document.documentElement.lang||navigator.language||"en").toLowerCase();return e.startsWith("fr")?"fr":e.startsWith("de")?"de":e.startsWith("br")?"br":"en"}),[a]),b=(0,o.useCallback)((()=>{if(!i)return;const{first:e,last:t}=i();m(e),p(t)}),[i]),v=(0,o.useCallback)((()=>{m(""),p("")}),[]);return(0,Je.jsx)("div",{className:"card shadow-sm",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)("h3",{className:"card-title mb-3",children:"demo"===e?"🐝 Try the demo":"🔐 Login"}),t&&(0,Je.jsx)("div",{className:"alert alert-danger",children:t}),"demo"===e?(0,Je.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),await r({preferredName:g,roles:s,lang:y()})},className:"d-grid gap-3",children:[(0,Je.jsxs)("div",{className:"row g-2",children:[(0,Je.jsx)("div",{className:"col",children:(0,Je.jsx)("input",{type:"text",className:"form-control",placeholder:"First name (optional)",value:h,onChange:e=>m(e.target.value)})}),(0,Je.jsx)("div",{className:"col",children:(0,Je.jsx)("input",{type:"text",className:"form-control",placeholder:"Last name (optional)",value:f,onChange:e=>p(e.target.value)})})]}),(0,Je.jsxs)("div",{className:"d-flex gap-2",children:[i&&(0,Je.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:b,children:"🎲 Random name"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-outline-secondary",onClick:v,children:"Clear"}),(0,Je.jsx)("div",{className:"ms-auto"}),(0,Je.jsx)("button",{type:"submit",className:"btn btn-warning",children:"Start demo"})]})]}):(0,Je.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),await n(l,u)},className:"d-grid gap-3",children:[(0,Je.jsx)("input",{type:"text",className:"form-control",placeholder:"Identifiant",value:l,onChange:e=>c(e.target.value),required:!0}),(0,Je.jsx)("input",{type:"password",className:"form-control",placeholder:"Mot de passe",autoComplete:"current-password",value:u,onChange:e=>d(e.target.value),required:!0}),(0,Je.jsx)("div",{className:"d-flex",children:(0,Je.jsx)("button",{type:"submit",className:"btn btn-primary ms-auto",children:"Login"})})]})]})})}function jt(e,t){return function(){return e.apply(t,arguments)}}const{toString:St}=Object.prototype,{getPrototypeOf:Nt}=Object,{iterator:Et,toStringTag:Rt}=Symbol,kt=(Ct=Object.create(null),e=>{const t=St.call(e);return Ct[t]||(Ct[t]=t.slice(8,-1).toLowerCase())});var Ct;const _t=e=>(e=e.toLowerCase(),t=>kt(t)===e),Ot=e=>t=>typeof t===e,{isArray:Tt}=Array,At=Ot("undefined"),Ft=_t("ArrayBuffer"),Pt=Ot("string"),Lt=Ot("function"),Dt=Ot("number"),Ut=e=>null!==e&&"object"==typeof e,Bt=e=>{if("object"!==kt(e))return!1;const t=Nt(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Rt in e||Et in e)},It=_t("Date"),$t=_t("File"),Mt=_t("Blob"),Wt=_t("FileList"),Jt=_t("URLSearchParams"),[qt,Ht,zt,Vt]=["ReadableStream","Request","Response","Headers"].map(_t);function Gt(e,t,{allOwnKeys:n=!1}={}){if(null==e)return;let r,a;if("object"!=typeof e&&(e=[e]),Tt(e))for(r=0,a=e.length;r<a;r++)t.call(null,e[r],r,e);else{const a=n?Object.getOwnPropertyNames(e):Object.keys(e),o=a.length;let s;for(r=0;r<o;r++)s=a[r],t.call(null,e[s],s,e)}}function Kt(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,a=n.length;for(;a-- >0;)if(r=n[a],t===r.toLowerCase())return r;return null}const Yt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,Xt=e=>!At(e)&&e!==Yt,Qt=(Zt="undefined"!=typeof Uint8Array&&Nt(Uint8Array),e=>Zt&&e instanceof Zt);var Zt;const en=_t("HTMLFormElement"),tn=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),nn=_t("RegExp"),rn=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Gt(n,((n,a)=>{let o;!1!==(o=t(n,a,e))&&(r[a]=o||n)})),Object.defineProperties(e,r)},an=_t("AsyncFunction"),on=(sn="function"==typeof setImmediate,ln=Lt(Yt.postMessage),sn?setImmediate:ln?(cn=`axios@${Math.random()}`,un=[],Yt.addEventListener("message",(({source:e,data:t})=>{e===Yt&&t===cn&&un.length&&un.shift()()}),!1),e=>{un.push(e),Yt.postMessage(cn,"*")}):e=>setTimeout(e));var sn,ln,cn,un;const dn="undefined"!=typeof queueMicrotask?queueMicrotask.bind(Yt):"undefined"!=typeof process&&process.nextTick||on,hn={isArray:Tt,isArrayBuffer:Ft,isBuffer:function(e){return null!==e&&!At(e)&&null!==e.constructor&&!At(e.constructor)&&Lt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||Lt(e.append)&&("formdata"===(t=kt(e))||"object"===t&&Lt(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Ft(e.buffer),t},isString:Pt,isNumber:Dt,isBoolean:e=>!0===e||!1===e,isObject:Ut,isPlainObject:Bt,isReadableStream:qt,isRequest:Ht,isResponse:zt,isHeaders:Vt,isUndefined:At,isDate:It,isFile:$t,isBlob:Mt,isRegExp:nn,isFunction:Lt,isStream:e=>Ut(e)&&Lt(e.pipe),isURLSearchParams:Jt,isTypedArray:Qt,isFileList:Wt,forEach:Gt,merge:function e(){const{caseless:t}=Xt(this)&&this||{},n={},r=(r,a)=>{const o=t&&Kt(n,a)||a;Bt(n[o])&&Bt(r)?n[o]=e(n[o],r):Bt(r)?n[o]=e({},r):Tt(r)?n[o]=r.slice():n[o]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&Gt(arguments[e],r);return n},extend:(e,t,n,{allOwnKeys:r}={})=>(Gt(t,((t,r)=>{n&&Lt(t)?e[r]=jt(t,n):e[r]=t}),{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let a,o,s;const i={};if(t=t||{},null==e)return t;do{for(a=Object.getOwnPropertyNames(e),o=a.length;o-- >0;)s=a[o],r&&!r(s,e,t)||i[s]||(t[s]=e[s],i[s]=!0);e=!1!==n&&Nt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:kt,kindOfTest:_t,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(Tt(e))return e;let t=e.length;if(!Dt(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Et]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:en,hasOwnProperty:tn,hasOwnProp:tn,reduceDescriptors:rn,freezeMethods:e=>{rn(e,((t,n)=>{if(Lt(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];Lt(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach((e=>{n[e]=!0}))};return Tt(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Kt,global:Yt,isContextDefined:Xt,isSpecCompliantForm:function(e){return!!(e&&Lt(e.append)&&"FormData"===e[Rt]&&e[Et])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(Ut(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const a=Tt(e)?[]:{};return Gt(e,((e,t)=>{const o=n(e,r+1);!At(o)&&(a[t]=o)})),t[r]=void 0,a}}return e};return n(e,0)},isAsyncFn:an,isThenable:e=>e&&(Ut(e)||Lt(e))&&Lt(e.then)&&Lt(e.catch),setImmediate:on,asap:dn,isIterable:e=>null!=e&&Lt(e[Et])};function mn(e,t,n,r,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),a&&(this.response=a,this.status=a.status?a.status:null)}hn.inherits(mn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:hn.toJSONObject(this.config),code:this.code,status:this.status}}});const fn=mn.prototype,pn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{pn[e]={value:e}})),Object.defineProperties(mn,pn),Object.defineProperty(fn,"isAxiosError",{value:!0}),mn.from=(e,t,n,r,a,o)=>{const s=Object.create(fn);return hn.toFlatObject(e,s,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),mn.call(s,e.message,t,n,r,a),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};const gn=mn;function yn(e){return hn.isPlainObject(e)||hn.isArray(e)}function bn(e){return hn.endsWith(e,"[]")?e.slice(0,-2):e}function vn(e,t,n){return e?e.concat(t).map((function(e,t){return e=bn(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}const wn=hn.toFlatObject(hn,{},null,(function(e){return/^is[A-Z]/.test(e)})),xn=function(e,t,n){if(!hn.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=hn.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!hn.isUndefined(t[e])}))).metaTokens,a=n.visitor||c,o=n.dots,s=n.indexes,i=(n.Blob||"undefined"!=typeof Blob&&Blob)&&hn.isSpecCompliantForm(t);if(!hn.isFunction(a))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(hn.isDate(e))return e.toISOString();if(!i&&hn.isBlob(e))throw new gn("Blob is not supported. Use a Buffer instead.");return hn.isArrayBuffer(e)||hn.isTypedArray(e)?i&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,a){let i=e;if(e&&!a&&"object"==typeof e)if(hn.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(hn.isArray(e)&&function(e){return hn.isArray(e)&&!e.some(yn)}(e)||(hn.isFileList(e)||hn.endsWith(n,"[]"))&&(i=hn.toArray(e)))return n=bn(n),i.forEach((function(e,r){!hn.isUndefined(e)&&null!==e&&t.append(!0===s?vn([n],r,o):null===s?n:n+"[]",l(e))})),!1;return!!yn(e)||(t.append(vn(a,n,o),l(e)),!1)}const u=[],d=Object.assign(wn,{defaultVisitor:c,convertValue:l,isVisitable:yn});if(!hn.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!hn.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),hn.forEach(n,(function(n,o){!0===(!(hn.isUndefined(n)||null===n)&&a.call(t,n,hn.isString(o)?o.trim():o,r,d))&&e(n,r?r.concat(o):[o])})),u.pop()}}(e),t};function jn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function Sn(e,t){this._pairs=[],e&&xn(e,this,t)}const Nn=Sn.prototype;Nn.append=function(e,t){this._pairs.push([e,t])},Nn.toString=function(e){const t=e?function(t){return e.call(this,t,jn)}:jn;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};const En=Sn;function Rn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function kn(e,t,n){if(!t)return e;const r=n&&n.encode||Rn;hn.isFunction(n)&&(n={serialize:n});const a=n&&n.serialize;let o;if(o=a?a(t,n):hn.isURLSearchParams(t)?t.toString():new En(t,n).toString(r),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const Cn=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){hn.forEach(this.handlers,(function(t){null!==t&&e(t)}))}},On={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Tn={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:En,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},An="undefined"!=typeof window&&"undefined"!=typeof document,Fn="object"==typeof navigator&&navigator||void 0,Pn=An&&(!Fn||["ReactNative","NativeScript","NS"].indexOf(Fn.product)<0),Ln="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,Dn=An&&window.location.href||"http://localhost",Un={...r,...Tn},Bn=function(e){function t(e,n,r,a){let o=e[a++];if("__proto__"===o)return!0;const s=Number.isFinite(+o),i=a>=e.length;return o=!o&&hn.isArray(r)?r.length:o,i?(hn.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!s):(r[o]&&hn.isObject(r[o])||(r[o]=[]),t(e,n,r[o],a)&&hn.isArray(r[o])&&(r[o]=function(e){const t={},n=Object.keys(e);let r;const a=n.length;let o;for(r=0;r<a;r++)o=n[r],t[o]=e[o];return t}(r[o])),!s)}if(hn.isFormData(e)&&hn.isFunction(e.entries)){const n={};return hn.forEachEntry(e,((e,r)=>{t(function(e){return hn.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),r,n,0)})),n}return null},In={transitional:On,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,a=hn.isObject(e);if(a&&hn.isHTMLForm(e)&&(e=new FormData(e)),hn.isFormData(e))return r?JSON.stringify(Bn(e)):e;if(hn.isArrayBuffer(e)||hn.isBuffer(e)||hn.isStream(e)||hn.isFile(e)||hn.isBlob(e)||hn.isReadableStream(e))return e;if(hn.isArrayBufferView(e))return e.buffer;if(hn.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return xn(e,new Un.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return Un.isNode&&hn.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=hn.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return xn(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),function(e){if(hn.isString(e))try{return(0,JSON.parse)(e),hn.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||In.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(hn.isResponse(e)||hn.isReadableStream(e))return e;if(e&&hn.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw gn.from(e,gn.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Un.classes.FormData,Blob:Un.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};hn.forEach(["delete","get","head","post","put","patch"],(e=>{In.headers[e]={}}));const $n=In,Mn=hn.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Wn=Symbol("internals");function Jn(e){return e&&String(e).trim().toLowerCase()}function qn(e){return!1===e||null==e?e:hn.isArray(e)?e.map(qn):String(e)}function Hn(e,t,n,r,a){return hn.isFunction(r)?r.call(this,t,n):(a&&(t=n),hn.isString(t)?hn.isString(r)?-1!==t.indexOf(r):hn.isRegExp(r)?r.test(t):void 0:void 0)}class zn{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function a(e,t,n){const a=Jn(t);if(!a)throw new Error("header name must be a non-empty string");const o=hn.findKey(r,a);(!o||void 0===r[o]||!0===n||void 0===n&&!1!==r[o])&&(r[o||t]=qn(e))}const o=(e,t)=>hn.forEach(e,((e,n)=>a(e,n,t)));if(hn.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(hn.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const t={};let n,r,a;return e&&e.split("\n").forEach((function(e){a=e.indexOf(":"),n=e.substring(0,a).trim().toLowerCase(),r=e.substring(a+1).trim(),!n||t[n]&&Mn[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)})),t})(e),t);else if(hn.isObject(e)&&hn.isIterable(e)){let n,r,a={};for(const t of e){if(!hn.isArray(t))throw TypeError("Object iterator must return a key-value pair");a[r=t[0]]=(n=a[r])?hn.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}o(a,t)}else null!=e&&a(t,e,n);return this}get(e,t){if(e=Jn(e)){const n=hn.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(hn.isFunction(t))return t.call(this,e,n);if(hn.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Jn(e)){const n=hn.findKey(this,e);return!(!n||void 0===this[n]||t&&!Hn(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function a(e){if(e=Jn(e)){const a=hn.findKey(n,e);!a||t&&!Hn(0,n[a],a,t)||(delete n[a],r=!0)}}return hn.isArray(e)?e.forEach(a):a(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const a=t[n];e&&!Hn(0,this[a],a,e,!0)||(delete this[a],r=!0)}return r}normalize(e){const t=this,n={};return hn.forEach(this,((r,a)=>{const o=hn.findKey(n,a);if(o)return t[o]=qn(r),void delete t[a];const s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,n)=>t.toUpperCase()+n))}(a):String(a).trim();s!==a&&delete t[a],t[s]=qn(r),n[s]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return hn.forEach(this,((n,r)=>{null!=n&&!1!==n&&(t[r]=e&&hn.isArray(n)?n.join(", "):n)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const n=new this(e);return t.forEach((e=>n.set(e))),n}static accessor(e){const t=(this[Wn]=this[Wn]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=Jn(e);t[r]||(function(e,t){const n=hn.toCamelCase(" "+t);["get","set","has"].forEach((r=>{Object.defineProperty(e,r+n,{value:function(e,n,a){return this[r].call(this,t,e,n,a)},configurable:!0})}))}(n,e),t[r]=!0)}return hn.isArray(e)?e.forEach(r):r(e),this}}zn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),hn.reduceDescriptors(zn.prototype,(({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[n]=e}}})),hn.freezeMethods(zn);const Vn=zn;function Gn(e,t){const n=this||$n,r=t||n,a=Vn.from(r.headers);let o=r.data;return hn.forEach(e,(function(e){o=e.call(n,o,a.normalize(),t?t.status:void 0)})),a.normalize(),o}function Kn(e){return!(!e||!e.__CANCEL__)}function Yn(e,t,n){gn.call(this,null==e?"canceled":e,gn.ERR_CANCELED,t,n),this.name="CanceledError"}hn.inherits(Yn,gn,{__CANCEL__:!0});const Xn=Yn;function Qn(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new gn("Request failed with status code "+n.status,[gn.ERR_BAD_REQUEST,gn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const Zn=(e,t,n=3)=>{let r=0;const a=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let a,o=0,s=0;return t=void 0!==t?t:1e3,function(i){const l=Date.now(),c=r[s];a||(a=l),n[o]=i,r[o]=l;let u=s,d=0;for(;u!==o;)d+=n[u++],u%=e;if(o=(o+1)%e,o===s&&(s=(s+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(1e3*d/h):void 0}}(50,250);return function(e,t){let n,r,a=0,o=1e3/t;const s=(t,o=Date.now())=>{a=o,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),i=t-a;i>=o?s(e,t):(n=e,r||(r=setTimeout((()=>{r=null,s(n)}),o-i)))},()=>n&&s(n)]}((n=>{const o=n.loaded,s=n.lengthComputable?n.total:void 0,i=o-r,l=a(i);r=o,e({loaded:o,total:s,progress:s?o/s:void 0,bytes:i,rate:l||void 0,estimated:l&&s&&o<=s?(s-o)/l:void 0,event:n,lengthComputable:null!=s,[t?"download":"upload"]:!0})}),n)},er=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},tr=e=>(...t)=>hn.asap((()=>e(...t))),nr=Un.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Un.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Un.origin),Un.navigator&&/(msie|trident)/i.test(Un.navigator.userAgent)):()=>!0,rr=Un.hasStandardBrowserEnv?{write(e,t,n,r,a,o){const s=[e+"="+encodeURIComponent(t)];hn.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),hn.isString(r)&&s.push("path="+r),hn.isString(a)&&s.push("domain="+a),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function ar(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const or=e=>e instanceof Vn?{...e}:e;function sr(e,t){t=t||{};const n={};function r(e,t,n,r){return hn.isPlainObject(e)&&hn.isPlainObject(t)?hn.merge.call({caseless:r},e,t):hn.isPlainObject(t)?hn.merge({},t):hn.isArray(t)?t.slice():t}function a(e,t,n,a){return hn.isUndefined(t)?hn.isUndefined(e)?void 0:r(void 0,e,0,a):r(e,t,0,a)}function o(e,t){if(!hn.isUndefined(t))return r(void 0,t)}function s(e,t){return hn.isUndefined(t)?hn.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function i(n,a,o){return o in t?r(n,a):o in e?r(void 0,n):void 0}const l={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:i,headers:(e,t,n)=>a(or(e),or(t),0,!0)};return hn.forEach(Object.keys(Object.assign({},e,t)),(function(r){const o=l[r]||a,s=o(e[r],t[r],r);hn.isUndefined(s)&&o!==i||(n[r]=s)})),n}const ir=e=>{const t=sr({},e);let n,{data:r,withXSRFToken:a,xsrfHeaderName:o,xsrfCookieName:s,headers:i,auth:l}=t;if(t.headers=i=Vn.from(i),t.url=kn(ar(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),hn.isFormData(r))if(Un.hasStandardBrowserEnv||Un.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(n=i.getContentType())){const[e,...t]=n?n.split(";").map((e=>e.trim())).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if(Un.hasStandardBrowserEnv&&(a&&hn.isFunction(a)&&(a=a(t)),a||!1!==a&&nr(t.url))){const e=o&&s&&rr.read(s);e&&i.set(o,e)}return t},lr="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){const r=ir(e);let a=r.data;const o=Vn.from(r.headers).normalize();let s,i,l,c,u,{responseType:d,onUploadProgress:h,onDownloadProgress:m}=r;function f(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(s),r.signal&&r.signal.removeEventListener("abort",s)}let p=new XMLHttpRequest;function g(){if(!p)return;const r=Vn.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());Qn((function(e){t(e),f()}),(function(e){n(e),f()}),{data:d&&"text"!==d&&"json"!==d?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p}),p=null}p.open(r.method.toUpperCase(),r.url,!0),p.timeout=r.timeout,"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(g)},p.onabort=function(){p&&(n(new gn("Request aborted",gn.ECONNABORTED,e,p)),p=null)},p.onerror=function(){n(new gn("Network Error",gn.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const a=r.transitional||On;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new gn(t,a.clarifyTimeoutError?gn.ETIMEDOUT:gn.ECONNABORTED,e,p)),p=null},void 0===a&&o.setContentType(null),"setRequestHeader"in p&&hn.forEach(o.toJSON(),(function(e,t){p.setRequestHeader(t,e)})),hn.isUndefined(r.withCredentials)||(p.withCredentials=!!r.withCredentials),d&&"json"!==d&&(p.responseType=r.responseType),m&&([l,u]=Zn(m,!0),p.addEventListener("progress",l)),h&&p.upload&&([i,c]=Zn(h),p.upload.addEventListener("progress",i),p.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(s=t=>{p&&(n(!t||t.type?new Xn(null,e,p):t),p.abort(),p=null)},r.cancelToken&&r.cancelToken.subscribe(s),r.signal&&(r.signal.aborted?s():r.signal.addEventListener("abort",s)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);y&&-1===Un.protocols.indexOf(y)?n(new gn("Unsupported protocol "+y+":",gn.ERR_BAD_REQUEST,e)):p.send(a||null)}))},cr=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const a=function(e){if(!n){n=!0,s();const t=e instanceof Error?e:this.reason;r.abort(t instanceof gn?t:new Xn(t instanceof Error?t.message:t))}};let o=t&&setTimeout((()=>{o=null,a(new gn(`timeout ${t} of ms exceeded`,gn.ETIMEDOUT))}),t);const s=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(a):e.removeEventListener("abort",a)})),e=null)};e.forEach((e=>e.addEventListener("abort",a)));const{signal:i}=r;return i.unsubscribe=()=>hn.asap(s),i}},ur=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,a=0;for(;a<n;)r=a+t,yield e.slice(a,r),a=r},dr=(e,t,n,r)=>{const a=async function*(e,t){for await(const n of async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}}(e))yield*ur(n,t)}(e,t);let o,s=0,i=e=>{o||(o=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await a.next();if(t)return i(),void e.close();let o=r.byteLength;if(n){let e=s+=o;n(e)}e.enqueue(new Uint8Array(r))}catch(e){throw i(e),e}},cancel:e=>(i(e),a.return())},{highWaterMark:2})},hr="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,mr=hr&&"function"==typeof ReadableStream,fr=hr&&("function"==typeof TextEncoder?(vr=new TextEncoder,e=>vr.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer())),pr=(e,...t)=>{try{return!!e(...t)}catch(e){return!1}},gr=mr&&pr((()=>{let e=!1;const t=new Request(Un.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),yr=mr&&pr((()=>hn.isReadableStream(new Response("").body))),br={stream:yr&&(e=>e.body)};var vr,wr;hr&&(wr=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!br[e]&&(br[e]=hn.isFunction(wr[e])?t=>t[e]():(t,n)=>{throw new gn(`Response type '${e}' is not supported`,gn.ERR_NOT_SUPPORT,n)})})));const xr={http:null,xhr:lr,fetch:hr&&(async e=>{let{url:t,method:n,data:r,signal:a,cancelToken:o,timeout:s,onDownloadProgress:i,onUploadProgress:l,responseType:c,headers:u,withCredentials:d="same-origin",fetchOptions:h}=ir(e);c=c?(c+"").toLowerCase():"text";let m,f=cr([a,o&&o.toAbortSignal()],s);const p=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let g;try{if(l&&gr&&"get"!==n&&"head"!==n&&0!==(g=await(async(e,t)=>{const n=hn.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(hn.isBlob(e))return e.size;if(hn.isSpecCompliantForm(e)){const t=new Request(Un.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return hn.isArrayBufferView(e)||hn.isArrayBuffer(e)?e.byteLength:(hn.isURLSearchParams(e)&&(e+=""),hn.isString(e)?(await fr(e)).byteLength:void 0)})(t):n})(u,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(hn.isFormData(r)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=er(g,Zn(tr(l)));r=dr(n.body,65536,e,t)}}hn.isString(d)||(d=d?"include":"omit");const a="credentials"in Request.prototype;m=new Request(t,{...h,signal:f,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:a?d:void 0});let o=await fetch(m);const s=yr&&("stream"===c||"response"===c);if(yr&&(i||s&&p)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=o[t]}));const t=hn.toFiniteNumber(o.headers.get("content-length")),[n,r]=i&&er(t,Zn(tr(i),!0))||[];o=new Response(dr(o.body,65536,n,(()=>{r&&r(),p&&p()})),e)}c=c||"text";let y=await br[hn.findKey(br,c)||"text"](o,e);return!s&&p&&p(),await new Promise(((t,n)=>{Qn(t,n,{data:y,headers:Vn.from(o.headers),status:o.status,statusText:o.statusText,config:e,request:m})}))}catch(t){if(p&&p(),t&&"TypeError"===t.name&&/Load failed|fetch/i.test(t.message))throw Object.assign(new gn("Network Error",gn.ERR_NETWORK,e,m),{cause:t.cause||t});throw gn.from(t,t&&t.code,e,m)}})};hn.forEach(xr,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}}));const jr=e=>`- ${e}`,Sr=e=>hn.isFunction(e)||null===e||!1===e,Nr=e=>{e=hn.isArray(e)?e:[e];const{length:t}=e;let n,r;const a={};for(let o=0;o<t;o++){let t;if(n=e[o],r=n,!Sr(n)&&(r=xr[(t=String(n)).toLowerCase()],void 0===r))throw new gn(`Unknown adapter '${t}'`);if(r)break;a[t||"#"+o]=r}if(!r){const e=Object.entries(a).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));let n=t?e.length>1?"since :\n"+e.map(jr).join("\n"):" "+jr(e[0]):"as no adapter specified";throw new gn("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function Er(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Xn(null,e)}function Rr(e){return Er(e),e.headers=Vn.from(e.headers),e.data=Gn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Nr(e.adapter||$n.adapter)(e).then((function(t){return Er(e),t.data=Gn.call(e,e.transformResponse,t),t.headers=Vn.from(t.headers),t}),(function(t){return Kn(t)||(Er(e),t&&t.response&&(t.response.data=Gn.call(e,e.transformResponse,t.response),t.response.headers=Vn.from(t.response.headers))),Promise.reject(t)}))}const kr={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{kr[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));const Cr={};kr.transitional=function(e,t,n){function r(e,t){return"[Axios v1.9.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,a,o)=>{if(!1===e)throw new gn(r(a," has been removed"+(t?" in "+t:"")),gn.ERR_DEPRECATED);return t&&!Cr[a]&&(Cr[a]=!0,console.warn(r(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,o)}},kr.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};const _r={assertOptions:function(e,t,n){if("object"!=typeof e)throw new gn("options must be an object",gn.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let a=r.length;for(;a-- >0;){const o=r[a],s=t[o];if(s){const t=e[o],n=void 0===t||s(t,o,e);if(!0!==n)throw new gn("option "+o+" must be "+n,gn.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new gn("Unknown option "+o,gn.ERR_BAD_OPTION)}},validators:kr},Or=_r.validators;class Tr{constructor(e){this.defaults=e||{},this.interceptors={request:new Cn,response:new Cn}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t={};Error.captureStackTrace?Error.captureStackTrace(t):t=new Error;const n=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?n&&!String(e.stack).endsWith(n.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+n):e.stack=n}catch(e){}}throw e}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=sr(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:a}=t;void 0!==n&&_r.assertOptions(n,{silentJSONParsing:Or.transitional(Or.boolean),forcedJSONParsing:Or.transitional(Or.boolean),clarifyTimeoutError:Or.transitional(Or.boolean)},!1),null!=r&&(hn.isFunction(r)?t.paramsSerializer={serialize:r}:_r.assertOptions(r,{encode:Or.function,serialize:Or.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),_r.assertOptions(t,{baseUrl:Or.spelling("baseURL"),withXsrfToken:Or.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&hn.merge(a.common,a[t.method]);a&&hn.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete a[e]})),t.headers=Vn.concat(o,a);const s=[];let i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let u,d=0;if(!i){const e=[Rr.bind(this),void 0];for(e.unshift.apply(e,s),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);d<u;)c=c.then(e[d++],e[d++]);return c}u=s.length;let h=t;for(d=0;d<u;){const e=s[d++],t=s[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{c=Rr.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,u=l.length;d<u;)c=c.then(l[d++],l[d++]);return c}getUri(e){return kn(ar((e=sr(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}hn.forEach(["delete","get","head","options"],(function(e){Tr.prototype[e]=function(t,n){return this.request(sr(n||{},{method:e,url:t,data:(n||{}).data}))}})),hn.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,a){return this.request(sr(a||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Tr.prototype[e]=t(),Tr.prototype[e+"Form"]=t(!0)}));const Ar=Tr;class Fr{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const n=this;this.promise.then((e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null})),this.promise.then=e=>{let t;const r=new Promise((e=>{n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e,r,a){n.reason||(n.reason=new Xn(e,r,a),t(n.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Fr((function(t){e=t})),cancel:e}}}const Pr=Fr,Lr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Lr).forEach((([e,t])=>{Lr[t]=e}));const Dr=Lr,Ur=function e(t){const n=new Ar(t),r=jt(Ar.prototype.request,n);return hn.extend(r,Ar.prototype,n,{allOwnKeys:!0}),hn.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(sr(t,n))},r}($n);Ur.Axios=Ar,Ur.CanceledError=Xn,Ur.CancelToken=Pr,Ur.isCancel=Kn,Ur.VERSION="1.9.0",Ur.toFormData=xn,Ur.AxiosError=gn,Ur.Cancel=Ur.CanceledError,Ur.all=function(e){return Promise.all(e)},Ur.spread=function(e){return function(t){return e.apply(null,t)}},Ur.isAxiosError=function(e){return hn.isObject(e)&&!0===e.isAxiosError},Ur.mergeConfig=sr,Ur.AxiosHeaders=Vn,Ur.formToJSON=e=>Bn(hn.isHTMLForm(e)?new FormData(e):e),Ur.getAdapter=Nr,Ur.HttpStatusCode=Dr,Ur.default=Ur;const Br=Ur,Ir=e=>e.replace(/\/+$/,"");function $r(e){const{baseUrl:t,basePath:n,service:r,nonceKeys:a,timeoutMs:o=15e3,meta:s}=e,i=t?null:Qe(new Error("API base is missing"),{code:"NO_BASE_API",severity:"page",category:"network",functionName:"createAxiosClient",service:"config",message:"API is not configured. Check plugin settings or environment variables.",retryable:!1,...s?{meta:s}:{}}),l=Br.create({baseURL:t?(c=t,u=n,`${c.replace(/\/+$/,"")}/${u.replace(/^\/+/,"")}`):"/__invalid_base__",timeout:o,withCredentials:!0});var c,u;return l.interceptors.request.use((e=>{if(i)return Promise.reject(i);const t=function(e=["beeNonce","pomolobeeSettings"]){if("undefined"==typeof window)return null;const t=window;if(t.beeNonce)return t.beeNonce;for(const n of e){const e=t[n]?.nonce;if(e)return String(e)}return null}(a);return t&&(e.headers={...e.headers||{},"X-WP-Nonce":t}),e})),l.interceptors.response.use((e=>e),(e=>{const t=e?.id?e:Qe(e,{service:r,functionName:"axios",...s?{meta:s}:{}});return We.emit(t),Promise.reject(t)})),l}function Mr(e){return e?{Authorization:`Bearer ${e}`}:{}}var Wr;const Jr=$r({baseUrl:"undefined"!=typeof window&&null!==(Wr=window?.pomolobeeSettings?.apiBase)&&void 0!==Wr?Wr:null,basePath:"/user",service:"user"}),qr=[{code:"en",label:"English"},{code:"fr",label:"Français"},{code:"de",label:"Deutsch"},{code:"br",label:"Brezhoneg"}];function Hr({onSave:e,className:t,compact:n}){var r,a,s,i;const{user:l,login:c}=vt(),[u,d]=(0,o.useState)(null!==(r=l?.first_name)&&void 0!==r?r:""),[h,m]=(0,o.useState)(null!==(a=l?.last_name)&&void 0!==a?a:""),[f,p]=(0,o.useState)(null!==(s=l?.lang)&&void 0!==s?s:"en"),[g,y]=(0,o.useState)(!1),[b,v]=(0,o.useState)(null);(0,o.useEffect)((()=>{l&&(d(l.first_name),m(l.last_name),p(l.lang))}),[l?.id]);const w=(0,o.useMemo)((()=>!!u.trim()&&!!h.trim()&&!!f),[u,h,f]);return l?(0,Je.jsx)("form",{onSubmit:async t=>{if(t.preventDefault(),w&&!g){y(!0),v(null);try{const t={first_name:u.trim(),last_name:h.trim(),lang:f},n=e?await e(t):(await Jr.put("/me",t)).data,r=localStorage.getItem("authToken")||"";c(r,n),v("ok")}catch{v("err")}finally{y(!1)}}},className:t,children:(0,Je.jsx)("div",{className:"card shadow-sm "+(n?"p-2":""),children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)("h5",{className:"card-title mb-3",children:"Profile"}),(0,Je.jsxs)("div",{className:"row g-2 mb-3",children:[(0,Je.jsxs)("div",{className:"col-sm-6",children:[(0,Je.jsx)("label",{className:"form-label",children:"First name"}),(0,Je.jsx)("input",{className:"form-control",value:u,onChange:e=>d(e.target.value)})]}),(0,Je.jsxs)("div",{className:"col-sm-6",children:[(0,Je.jsx)("label",{className:"form-label",children:"Last name"}),(0,Je.jsx)("input",{className:"form-control",value:h,onChange:e=>m(e.target.value)})]})]}),(0,Je.jsxs)("div",{className:"mb-3",children:[(0,Je.jsx)("label",{className:"form-label",children:"Language"}),(0,Je.jsx)("select",{className:"form-select",value:f,onChange:e=>p(e.target.value),children:qr.map((e=>(0,Je.jsx)("option",{value:e.code,children:e.label},e.code)))})]}),(0,Je.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,Je.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:!w||g,children:g?"Saving…":"Save changes"}),"ok"===b&&(0,Je.jsx)("span",{className:"text-success",children:"Saved ✓"}),"err"===b&&(0,Je.jsx)("span",{className:"text-danger",children:"Could not save"}),(0,Je.jsx)("div",{className:"ms-auto small text-muted",children:l.is_demo?`Demo expires: ${null!==(i=l.demo_expires_at)&&void 0!==i?i:"—"}`:null})]})]})})}):null}const zr=(e,t=Math.random)=>{const n=e.slice();for(let e=n.length-1;e>0;e--){const r=Math.floor(t()*(e+1));[n[e],n[r]]=[n[r],n[e]]}return n},Vr=(e,t=Math.random)=>{let n=zr(e,t),r=0;return()=>{const a=n[r++];return r>=n.length&&(n=zr(e,t),r=0),a}},Gr=Vr(["Jack","John","James","Jacob","Joshua","Joseph","Jason","Justin","Jonathan","Jeremy","Jeffrey","George","Gavin","Liam","Noah","Ethan","Logan","Lucas","Henry","William","Michael","David","Daniel","Matthew","Andrew","Anthony","Alexander","Samuel","Benjamin","Christopher","Ryan","Thomas","Nathan","Nicholas","Tyler","Adam","Aaron","Dylan","Brandon","Eric"]),Kr=Vr(["Lisa","Emma","Olivia","Sophia","Ava","Mia","Amelia","Isabella","Charlotte","Emily","Abigail","Harper","Evelyn","Ella","Chloe","Grace","Lily","Madison","Aria","Zoe","Hannah","Natalie","Victoria","Nora","Aurora","Stella","Lucy","Samantha","Leah","Sarah","Audrey","Claire","Savannah","Brooklyn","Paisley","Penelope","Layla","Mila","Scarlett","Ellie"]),Yr=Vr(["Alex","Sam","Taylor","Jordan","Jamie","Casey","Riley","Morgan","Cameron","Quinn","Avery","Charlie","Dakota","Finley","Hayden","Parker","Rowan","Skyler","Reese","Sidney"]),Xr=Vr(["The Brave","The Swift","The Bold","The Clever","The Noble","The Jolly","The Quiet","The Lucky","The Sly","The Sunny","The Curious","The Fearless","The Merry","The Witty","The Kind","The Gentle","The Quick","The Eager","The Bright","The Calm","From Underworld","Of the North","Of the Valley","Of the Coast","Of the Highlands","Of the Lowlands","Of the River","Of the Forest","Of the Desert","Of the Islands","Storm Rider","Night Walker","Shadow Runner","Trail Blazer","Star Gazer","Moon Dancer","Sun Chaser","Wind Whisperer","Dream Weaver","Stone Breaker","Fire Keeper","Mist Walker","Sky Painter","Code Wizard","Bug Slayer","Pixel Pusher","Data Diver","Logic Tamer","Syntax Samurai","Signal Seeker"]);let Qr=null,Zr=0;function ea(){const e=((e=Math.random)=>{let t;for(let n=0;n<3;n++){const n=e();if(t=n<.4?"male":n<.8?"female":"unisex",!(Zr>=2&&t===Qr))break}return t===Qr?Zr++:(Qr=t,Zr=1),t})();return{first:"male"===e?Gr():"female"===e?Kr():Yr(),last:Xr(),bucket:e}}const ta=e=>{const t=X(),{pathname:n}=G(),{logout:r,token:a}=vt();(0,o.useEffect)((()=>{console.log("[useProtectedPage] Current token:",a),a||(r(),e&&e(),console.warn("[useProtectedPage] No valid token → redirecting to /login"),t("/login"))}),[t,n,a,r,e])};function na({initialDemoRoles:e=["roleundefined"],usePluginBootstrap:t,usePluginApis:n}){const r=X(),[a]=function(e){u("undefined"!=typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=o.useRef(pe(e)),n=o.useRef(!1),r=G(),a=o.useMemo((()=>function(e,t){let n=pe(e);return t&&t.forEach(((e,r)=>{n.has(r)||t.getAll(r).forEach((e=>{n.append(r,e)}))})),n}(r.search,n.current?null:t.current)),[r.search]),s=X(),i=o.useCallback(((e,t)=>{const r=pe("function"==typeof e?e(a):e);n.current=!0,s("?"+r,t)}),[s,a]);return[a,i]}(),s="demo"===a.get("mode")?"demo":"login",i=t?t():null,l=i?.fetchBootstrapData,c=n?n():null,d=c?.apiUser,{handleLogin:h,handleDemoStart:m,errorMessage:f}=function(e){const{apiUser:t,bootstrap:n}=e,{login:r}=vt(),[a,s]=(0,o.useState)(null);return{handleLogin:async(e,a,o)=>{try{const s=await t.post("/auth/login/",{username:e,password:a}),{access:i}=s.data,l=(await t.get("/users/me/",{headers:Mr(i)})).data;r(i,l),n&&await n(i,{force:!0}),o()}catch(e){s(401===e?.response?.status?"Invalid username or password":403===e?.response?.status?"Your account is not permitted to access this application.":"Connection error"),console.error("Login failed:",e?.response?.status,e?.response?.data||e)}},handleDemoStart:async(e,a={})=>{try{const o={roles:Array.isArray(a.roles)&&a.roles.length?a.roles:["teacher"]};a.preferredName?.trim()&&(o.preferred_name=a.preferredName.trim()),a.lang&&(o.lang=a.lang);const s=await t.post("/auth/demo/start/",o,{withCredentials:!0}),{access:i}=s.data,l=(await t.get("/users/me/",{headers:Mr(i),withCredentials:!0})).data;r(i,l),n&&await n(i,{force:!0}),e()}catch(e){s("Could not start demo right now."),console.error("Demo start failed:",e?.response?.status,e?.response?.data||e)}},errorMessage:a}}({apiUser:d,bootstrap:l});return(0,Je.jsx)("div",{className:"container py-4",children:(0,Je.jsx)("div",{className:"row justify-content-center",children:(0,Je.jsx)("div",{className:"col-12 col-sm-10 col-md-8 col-lg-6",children:(0,Je.jsx)("div",{className:"card shadow-sm",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)(xt,{mode:s,errorMessage:f,detectLang:()=>{const e=(document.documentElement.lang||navigator.language||"en").toLowerCase();return e.startsWith("fr")?"fr":e.startsWith("de")?"de":e.startsWith("br")?"br":"en"},initialRolesForDemo:e,getRandomDisplayName:ea,onSubmitLogin:async(e,t)=>{await h(e,t,(()=>r("/dashboard")))},onStartDemo:async t=>{const n=t.roles&&t.roles.length?t.roles:e;await m((()=>r("/dashboard")),{...t,roles:n})}}),(0,Je.jsx)("hr",{className:"my-4"}),(0,Je.jsx)("div",{className:"text-center",children:"demo"===s?(0,Je.jsxs)(Je.Fragment,{children:["Prefer to sign in? ",(0,Je.jsx)(Le,{to:"/login",className:"link-primary",children:"Go to login"})]}):(0,Je.jsxs)(Je.Fragment,{children:["Just exploring? ",(0,Je.jsx)(Le,{to:"/login?mode=demo",className:"link-warning",children:"Try the demo"})]})})]})})})})})}const ra=(0,o.createContext)(void 0),aa=({children:e})=>{const[t,n]=(0,o.useState)([]),[r,a]=(0,o.useState)(null),[s,i]=(0,o.useState)(null),[l,c]=(0,o.useState)([]),[u,d]=(0,o.useState)([]),[h,m]=(0,o.useState)([]),f=(0,o.useMemo)((()=>Object.fromEntries(l.map((e=>[e.field_id,e])))),[l]),p=(0,o.useMemo)((()=>{const e={};for(const t of h)e[t.field_id]||(e[t.field_id]=[]),e[t.field_id].push(t);return e}),[h]);return(0,o.useEffect)((()=>{console.log("[App] DEBUG farms set:",t)}),[t]),(0,o.useEffect)((()=>{console.log("[App] DEBUG fields set:",l)}),[l]),(0,o.useEffect)((()=>{console.log("[App] DEBUG fruits set:",u)}),[u]),(0,o.useEffect)((()=>{console.log("[App] rows set length:",h.length,"sample:",h.slice(0,3))}),[h]),(0,o.useEffect)((()=>{const e=Array.from(new Set(h.map((e=>e.field_id))));console.log("[App] rowsByFieldId keys:",e)}),[h]),(0,o.useEffect)((()=>{console.log("[App] activeFarm:",r,"activeField:",s)}),[r,s]),(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=localStorage.getItem("farms"),t=localStorage.getItem("activeFarm"),r=localStorage.getItem("activeField");e&&n(JSON.parse(e)),t&&a(JSON.parse(t)),r&&i(JSON.parse(r))}),[]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&(localStorage.setItem("fields",JSON.stringify(l)),localStorage.setItem("fruits",JSON.stringify(u)))}),[l,u]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&localStorage.setItem("farms",JSON.stringify(t))}),[t]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&(r?localStorage.setItem("activeFarm",JSON.stringify(r)):localStorage.removeItem("activeFarm"))}),[r]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&(s?localStorage.setItem("activeField",JSON.stringify(s)):localStorage.removeItem("activeField"))}),[s]),(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=localStorage.getItem("rows");e&&m(JSON.parse(e))}),[]),(0,o.useEffect)((()=>{"undefined"!=typeof window&&localStorage.setItem("rows",JSON.stringify(h))}),[h]),(0,Je.jsx)(ra.Provider,{value:{reset:()=>{n([]),c([]),m([]),d([]),a(null),i(null),"undefined"!=typeof window&&["farms","fields","fruits","rows","activeFarm","activeField"].forEach((e=>localStorage.removeItem(e))),console.log("[AppProvider] logout called")},farms:t,setFarms:e=>n(e),activeFarm:r,setActiveFarm:e=>{a(e),i(null)},activeField:s,setActiveField:e=>i(e),fields:l,setFields:e=>c(e),fieldsById:f,patchField:(e,t)=>{c((n=>n.map((n=>n.field_id===e?{...n,...t}:n)))),i((n=>{if(!n)return n;const r=n.field_id;return void 0!==n.orientation&&r===e?{...n,...t}:n}))},rows:h,setRows:e=>m(e),getFieldWithRows:e=>{var t;const n=l.find((t=>t.field_id===e));return n?{...n,rows:null!==(t=p[e])&&void 0!==t?t:[]}:null},rowsByFieldId:p,fruits:u,setFruits:e=>d(e)},children:e})},oa=()=>{const e=(0,o.useContext)(ra);if(!e)throw new Error("useApp must be used within AppProvider");return e},sa=()=>{const{isLoggedIn:e,logout:t,user:n}=vt(),{activeFarm:r,reset:a}=oa(),o=!!r&&!!n;return(0,Je.jsxs)("nav",{className:"navbar sticky-navbar",children:[(0,Je.jsx)("div",{className:"navbar-container",children:(0,Je.jsxs)("div",{className:"navbar-active-data",children:[(0,Je.jsx)(Le,{to:"/",className:"nav-link",children:"🏠 Home"}),e?(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)(Le,{to:"/dashboard",className:"nav-link",children:"📊 Dashboard"}),o?(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)(Le,{to:"/farm",className:"nav-link",children:"Farm Statistic"}),(0,Je.jsx)(Le,{to:"/farmmgt",className:"nav-link",children:"Farm Management"})]}):(0,Je.jsx)("span",{className:"nav-link disabled",children:"Please select a farm"}),(0,Je.jsx)("button",{className:"navbar-button",onClick:()=>{t(),a()},children:"🔓 Logout"})]}):(0,Je.jsx)(Le,{to:"/login",className:"nav-link",children:"🔓 Login"}),(0,Je.jsx)(Le,{to:"/errormgt",className:"nav-link",children:"Error Management"})]})}),!e&&(0,Je.jsx)("div",{className:"p-3 border-top bg-white",children:(0,Je.jsx)(Le,{to:"/login?mode=demo",className:"btn btn-warning btn-lg w-100",children:"🐝 Try the demo"})})]})},ia=({title:e,children:t,emoji:n})=>(0,Je.jsx)("div",{className:"col-md-6 mb-3",children:(0,Je.jsx)("div",{className:"card h-100",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsxs)("h5",{className:"card-title",children:[n?`${n} `:"",e]}),(0,Je.jsx)("div",{className:"card-text",children:t})]})})}),la=()=>{const e=X(),{isLoggedIn:t,user:n}=vt(),{farms:r}=oa(),a=r?.length||0,o=r?.reduce(((e,t)=>e+(t.fields?.length||0)),0)||0;return(0,Je.jsxs)("div",{className:"container my-4",children:[(0,Je.jsxs)("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-3 mb-3",children:[(0,Je.jsxs)("div",{children:[(0,Je.jsx)("h2",{className:"mb-1",children:"🍯 PomoloBee — Orchard Monitoring"}),(0,Je.jsx)("p",{className:"mb-0 text-muted",children:"WordPress plugin powered by a Django REST API. Authenticate as a farmer, select your farm & fields, and manage orchard images, estimates, and history."})]}),(0,Je.jsx)("div",{className:"d-flex gap-2",children:t?(0,Je.jsx)("button",{className:"btn btn-success",onClick:()=>e("/dashboard"),children:"📊 Go to Dashboard"}):(0,Je.jsx)("button",{className:"btn btn-primary",onClick:()=>e("/login"),children:"🔐 Log in"})})]}),(0,Je.jsx)("div",{className:"card mb-4",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)("h5",{className:"card-title",children:"👤 Status"}),t?(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsxs)("p",{className:"mb-2",children:["Logged in as ",(0,Je.jsxs)("strong",{children:[n?.first_name," ",n?.last_name]})," (",n?.username,")"]}),(0,Je.jsxs)("div",{className:"d-flex flex-wrap gap-3",children:[(0,Je.jsxs)("span",{className:"badge text-bg-secondary",children:["Farms: ",a]}),(0,Je.jsxs)("span",{className:"badge text-bg-secondary",children:["Fields: ",o]})]})]}):(0,Je.jsx)("p",{className:"mb-0",children:"You’re not logged in. Please use the button above to authenticate."})]})}),t&&a>0&&(0,Je.jsx)("div",{className:"card mb-4",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)("h5",{className:"card-title",children:"🏡 Your Farms & Fields"}),(0,Je.jsx)("div",{className:"table-responsive",children:(0,Je.jsxs)("table",{className:"table table-sm align-middle mb-0",children:[(0,Je.jsx)("thead",{children:(0,Je.jsxs)("tr",{children:[(0,Je.jsx)("th",{style:{width:200},children:"Farm"}),(0,Je.jsx)("th",{children:"Fields"})]})}),(0,Je.jsx)("tbody",{children:r.map((e=>(0,Je.jsxs)("tr",{children:[(0,Je.jsx)("td",{children:(0,Je.jsx)("strong",{children:e.name})}),(0,Je.jsx)("td",{children:e.fields?.length?e.fields.map((e=>(0,Je.jsx)("span",{className:"badge text-bg-light me-2 mb-1",children:e.short_name||e.name},e.field_id))):(0,Je.jsx)("span",{className:"text-muted",children:"No fields"})})]},e.farm_id)))})]})}),(0,Je.jsx)("div",{className:"mt-3",children:(0,Je.jsx)("button",{className:"btn btn-outline-primary",onClick:()=>e("/dashboard"),children:"Open Dashboard"})})]})}),(0,Je.jsxs)("div",{className:"row",children:[(0,Je.jsx)(ia,{title:"Authenticate & Authorize",emoji:"🔑",children:"Use JWT-based login via the Django API. Farmers see their own farm; admins can view all farms."}),(0,Je.jsx)(ia,{title:"Select Farm & Fields",emoji:"🌾",children:"The dashboard lists your farm(s) and fields. Choose a field to focus all actions and context."}),(0,Je.jsx)(ia,{title:"Images & Estimation",emoji:"📷",children:"Attach images to rows, run yield estimation (ML/Manual), and keep track over time."}),(0,Je.jsx)(ia,{title:"History & Reports",emoji:"📈",children:"Browse past estimations and visualize trends across dates, rows, and fruit types."})]}),(0,Je.jsx)("div",{className:"card mt-4",children:(0,Je.jsxs)("div",{className:"card-body",children:[(0,Je.jsx)("h5",{className:"card-title",children:"🛠️ Tech Overview"}),(0,Je.jsxs)("ul",{className:"mb-0",children:[(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"Frontend (WP plugin):"})," React + TypeScript + Bootstrap (enqueued by plugin)"]}),(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"Backend:"})," Django REST API (JWT auth, routers, serializers)"]}),(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"Data:"})," Farms with nested fields, rows, images, estimations"]}),(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"Security:"})," Same-origin proxy or strict CORS (prod)"]})]})]})})]})},ca=function(e){var t,n,r;const a=null!==(t=e?.settingsKey)&&void 0!==t?t:"beeSettings",o=null!==(n=e?.settingsProp)&&void 0!==n?n:"apiUrl",s=null!==(r=e?.envVars)&&void 0!==r?r:["VITE_BEE_API_BASE","BEE_API_BASE"];if("undefined"!=typeof window){const e=window?.[a]?.[o];if(e)return Ir(String(e))}for(const e of s){const t=process?.env?.[e];if(t)return Ir(String(t))}return null}({settingsKey:"pomolobeeSettings",settingsProp:"apiUrl",envVars:["VITE_POMOLOBEE_API_BASE","POMOLOBEE_API_BASE"]}),ua={plugin:"pomolobee"},da=$r({baseUrl:ca,basePath:"/user",service:"user",nonceKeys:["beeNonce","pomolobeeSettings"],meta:ua}),ha=$r({baseUrl:ca,basePath:"/pomolobee",service:"pomolobee",nonceKeys:["beeNonce","pomolobeeSettings"],meta:ua}),ma=Mr;function fa(e){return Array.isArray(e?.data?.locations)?e.data.locations:Array.isArray(e?.locations)?e.locations:Array.isArray(e)?e:[]}function pa(){const{token:e}=vt(),{farms:t,setFarms:n,fields:r,setFields:a,fruits:o,setFruits:s,rows:i,setRows:l,setActiveFarm:c}=oa(),u=t=>ma(null!=t?t:e);return{fetchBootstrapData:async(d,h={})=>{var m,f;const p=null!=d?d:e;if(!p)return void console.warn("[bootstrap] no token, bail");const g=h.force||0===t.length,y=h.force||0===o.length,b=h.force||0===i.length,v=u(p),w=g?ha.get("/farms/",{headers:v}):Promise.resolve({data:t}),x=y?ha.get("/fruits/",{headers:v}):Promise.resolve({data:o}),j=b?ha.get("/locations/",{headers:v}):Promise.resolve({data:null}),[S,N,E]=await Promise.all([w,x,j]),R=null!==(m=S.data)&&void 0!==m?m:t,k=null!==(f=N.data)&&void 0!==f?f:o;let C=r,_=i;if(b&&E?.data){const e=fa(E.data),t=new Map,n=[];for(const r of e){const e=r.field;t.set(e.field_id,e);for(const t of r.rows)n.push({...t,field_id:e.field_id})}C=Array.from(t.values()),_=n,console.log("[bootstrap] fields from locations:",C.length,"rows:",_.length)}n(R),s(k),a(C),l(_),1===R.length&&c(R[0])},fetchFieldById:async(e,t)=>{const n=(await ha.get(`/fields/${e}/`,{headers:u(t)})).data,o=[...r],s=o.findIndex((e=>e.field_id===n.field_id));return s>=0?o[s]=n:o.push(n),a(o),n},fetchLocationsOnly:async e=>{const t=fa((await ha.get("/locations/",{headers:u(e)})).data),n=new Map,r=[];for(const e of t){const t=e.field;n.set(t.field_id,t);for(const n of e.rows)r.push({...n,field_id:t.field_id})}return a(Array.from(n.values())),l(r),r}}}const ga=()=>(0,Je.jsx)(na,{plugin:"pomolobee",initialDemoRoles:["farmer"],usePluginBootstrap:pa,usePluginApis:()=>({apiUser:da})}),ya=()=>{const{activeFarm:e,activeField:t}=oa(),{user:n}=vt();return console.log("[ActiveContextCard] component called"),(0,Je.jsxs)("div",{className:"card p-3",children:[(0,Je.jsx)("h3",{children:"🔎 Active Context"}),(0,Je.jsxs)("ul",{className:"mb-0",children:[(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"👨‍🌾 User:"})," ",n?`${n.first_name} ${n.last_name} (${n.username})`:"Not logged in"]}),(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"🏡 Farm:"})," ",e?e.name:"None selected"]}),(0,Je.jsxs)("li",{children:[(0,Je.jsx)("strong",{children:"🗺️ Field:"})," ",t?`${t.name} (${t.short_name})`:"None selected"]})]})]})},ba=()=>(console.log("[Dashboard] component called"),ta((()=>reset())),(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("h1",{children:"📊 Dashboard"}),(0,Je.jsx)(ya,{})]})),va=()=>(0,Je.jsxs)(Je.Fragment,{children:["  ",(0,Je.jsx)(wt,{}),(0,Je.jsx)(ba,{})]}),wa=()=>{const{farms:e,activeFarm:t,setActiveFarm:n,activeField:r,setActiveField:a}=oa(),[s,i]=(0,o.useState)(""),l=e,c=(0,o.useMemo)((()=>{var e;const n=s?l.find((e=>e.farm_id===Number(s))):t||l[0];return null!==(e=n?.fields)&&void 0!==e?e:[]}),[s,l,t]);return console.log("[FieldSelection] component called"),l.length?(0,Je.jsxs)("div",{className:"card p-3 mb-3",children:[(0,Je.jsx)("h3",{children:"🏞️ Select Field"}),(0,Je.jsx)("div",{className:"row g-2 mb-3",children:(0,Je.jsxs)("div",{className:"col-sm-6",children:[(0,Je.jsx)("label",{className:"form-label",children:"Farm"}),(0,Je.jsx)("select",{className:"form-select",value:s,onChange:t=>(t=>{const r=t?Number(t):void 0,o=r&&e.find((e=>e.farm_id===r))||null;n(o||null),a(null),i(t?r:"")})(t.target.value),children:l.map((e=>(0,Je.jsx)("option",{value:e.farm_id,children:e.name},e.farm_id)))})]})}),(0,Je.jsxs)("table",{className:"table table-hover",children:[(0,Je.jsx)("thead",{children:(0,Je.jsxs)("tr",{children:[(0,Je.jsx)("th",{children:"Short"}),(0,Je.jsx)("th",{children:"Name"}),(0,Je.jsx)("th",{children:"Description"})]})}),(0,Je.jsxs)("tbody",{children:[c.map((e=>(0,Je.jsxs)("tr",{onClick:()=>a(e),style:{cursor:"pointer"},className:r&&"field_id"in r&&r.field_id===e.field_id?"table-primary":"",children:[(0,Je.jsx)("td",{children:e.short_name}),(0,Je.jsx)("td",{children:e.name}),(0,Je.jsx)("td",{children:e.description})]},e.field_id))),0===c.length&&(0,Je.jsx)("tr",{children:(0,Je.jsx)("td",{colSpan:3,className:"text-muted",children:"No fields for this farm."})})]})]})]}):(0,Je.jsx)("div",{className:"alert alert-info",children:"No farms available."})},xa=({row:e})=>(0,Je.jsx)("div",{className:"d-flex justify-content-between align-items-center border rounded px-2 py-1 mb-1",children:(0,Je.jsxs)("div",{className:"me-2",children:[(0,Je.jsxs)("div",{className:"fw-semibold",children:[e.short_name," — ",e.name]}),(0,Je.jsxs)("div",{className:"small text-muted",children:["Plants: ",e.nb_plant," • Fruit: ",e.fruit_type," (#",e.fruit_id,")"]})]})}),ja=({field:e})=>{var t,n,r,a,s,i,l,c;const{fieldsById:u,rowsByFieldId:d,getFieldWithRows:h,activeField:m}=oa(),f=null!==(t=null!=e?e:m)&&void 0!==t?t:null,p=(0,o.useMemo)((()=>{var e;return f?void 0!==f.orientation?f:null!==(e=u[f.field_id])&&void 0!==e?e:null:null}),[f,u]);if(!f)return(0,Je.jsxs)("div",{className:"card p-3",children:[(0,Je.jsx)("h3",{className:"mb-2",children:"Field"}),(0,Je.jsx)("div",{className:"text-muted",children:"No field selected."})]});const g=null!==(n=null!==(r=p?.field_id)&&void 0!==r?r:f.field_id)&&void 0!==n?n:null,y=g?h(g):null,b=null!==(a=y?.rows)&&void 0!==a?a:[],v=b.length||"—";console.debug("[FieldCard] fid=",g,"rows keys=",Object.keys(null!=d?d:{}),"rows len for fid=",b.length);const w=null!==(s=f.name)&&void 0!==s?s:`Field #${f.field_id}`,x=f.short_name,j=f.description,S=null!==(i=p?.orientation)&&void 0!==i?i:"—",N=null!==(l=p?.background_image_url)&&void 0!==l?l:null,E=null!==(c=p?.svg_map_url)&&void 0!==c?c:null;return(0,Je.jsxs)("div",{className:"card p-3",children:[(0,Je.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[(0,Je.jsx)("h3",{className:"mb-0",children:w}),(0,Je.jsx)("span",{className:"badge text-bg-secondary",children:x})]}),(0,Je.jsx)("div",{className:"mb-2 text-muted",children:j||"—"}),(0,Je.jsxs)("div",{className:"row g-3 align-items-stretch",children:[(0,Je.jsx)("div",{className:"col-12 col-lg-4",children:(0,Je.jsxs)("div",{className:"h-100 d-flex flex-column",children:[(0,Je.jsxs)("ul",{className:"list-unstyled mb-3",children:[(0,Je.jsxs)("li",{className:"mb-1",children:[(0,Je.jsx)("strong",{children:"Orientation:"})," ",S||"—"]}),(0,Je.jsxs)("li",{className:"mb-1",children:[(0,Je.jsx)("strong",{children:"Rows:"})," ",v]}),(0,Je.jsxs)("li",{className:"mb-1",children:[(0,Je.jsx)("strong",{children:"SVG map:"})," ",E?(0,Je.jsx)("a",{href:E,target:"_blank",rel:"noreferrer noopener",children:"Open SVG"}):"—"]}),(0,Je.jsxs)("li",{className:"mb-1",children:[(0,Je.jsx)("strong",{children:"Background:"})," ",N?(0,Je.jsx)("a",{href:N,target:"_blank",rel:"noreferrer noopener",children:"Open image"}):"—"]}),(0,Je.jsxs)("li",{className:"mb-1",children:[(0,Je.jsx)("strong",{children:"Production estimation:"})," —",(0,Je.jsx)("small",{className:"text-muted",children:" (depends on rows/estimates)"})]})]}),(0,Je.jsx)("div",{className:"mt-auto small text-muted",children:"Tip: use the links above to open full-size for zoom."})]})}),(0,Je.jsx)("div",{className:"col-12 col-lg-4",children:(0,Je.jsx)("div",{className:"border rounded overflow-hidden h-100 d-flex align-items-center justify-content-center",style:{minHeight:220,background:"#f8f9fa"},"aria-label":"SVG preview",children:E?(0,Je.jsx)("object",{data:E,type:"image/svg+xml",className:"w-100",style:{aspectRatio:"4 / 3"},"aria-label":"Field SVG map",children:(0,Je.jsx)("img",{src:E,alt:"Field SVG map",className:"img-fluid",style:{maxHeight:360,objectFit:"contain"}})}):(0,Je.jsx)("span",{className:"text-muted",children:"No SVG map"})})}),(0,Je.jsx)("div",{className:"col-12 col-lg-4",children:(0,Je.jsx)("div",{className:"border rounded overflow-hidden h-100 d-flex align-items-center justify-content-center",style:{minHeight:220,background:"#f8f9fa"},"aria-label":"Field background",children:N?(0,Je.jsx)("img",{src:N,alt:"Field background",className:"img-fluid",style:{maxHeight:360,width:"100%",objectFit:"cover"}}):(0,Je.jsx)("span",{className:"text-muted",children:"No background image"})})})]}),(0,Je.jsxs)("div",{className:"mt-3",children:[(0,Je.jsx)("h5",{className:"mb-2",children:"Rows"}),0===b.length?(0,Je.jsxs)("div",{className:"text-muted",children:["No rows found for this field.",(0,Je.jsxs)("div",{className:"small text-muted",children:["Debug: fid=",null!=g?g:"—",", have fieldIds=[",Object.keys(null!=d?d:{}).join(", "),"]"]})]}):(0,Je.jsx)("div",{children:b.map((e=>(0,Je.jsx)(xa,{row:e},e.row_id)))})]})]})},Sa=()=>{console.log("[Farm] component called"),ta((()=>reset()));const{activeField:e}=oa();return(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("h1",{children:"Farm"}),(0,Je.jsx)(wa,{}),(0,Je.jsx)(ya,{}),(0,Je.jsx)(ja,{field:e})]})},Na=()=>(0,Je.jsxs)(Je.Fragment,{children:["  ",(0,Je.jsx)(wt,{}),(0,Je.jsx)(Sa,{})]}),Ea=()=>(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("h2",{children:"Debug phase: test some errors"}),(0,Je.jsx)(tt,{apiApp:ha,apiUser:da,plugin:"pomolobee"}),(0,Je.jsx)("h3",{children:"Active error display"}),(0,Je.jsx)(et,{plugin:"pomolobee"}),(0,Je.jsx)("h3",{children:"History of all errors"}),(0,Je.jsx)(ut,{plugin:"pomolobee"})]}),Ra=({field:e,onSave:t,onBackgroundSaved:n})=>{var r,a;const{fieldsById:s}=useAuth(),{uploadBackground:i}=function(){const{token:e}=vt(),{patchField:t}=oa();return{uploadBackground:async function(n,r,a){var o,s;if(!e)throw new Error("No auth token");const i=new FormData;i.append("background_image",r,null!=a?a:r.name);const l=await ha.post(`/fields/${n}/background/`,i,{headers:{...ma(e)}}),c=null!==(o=null!==(s=l.data?.background_image_url)&&void 0!==s?s:l.data?.field?.background_image_url)&&void 0!==o?o:"string"==typeof l.data?l.data:null;if(!c)throw new Error("Upload succeeded but no background_image_url returned");return t(n,{background_image_url:c}),c}}}(),{uploadSvg:l}=function(){const{token:e}=vt(),{patchField:t}=oa();return{uploadSvg:async function(n,r){if(!e)throw new Error("No auth token");const a=new FormData;a.append("svg_map",r,r.name);try{var o,s;const r=await ha.post(`/fields/${n}/svg/`,a,{headers:{...ma(e)}}),i=null!==(o=null!==(s=r.data?.svg_map_url)&&void 0!==s?s:r.data?.field?.svg_map_url)&&void 0!==o?o:"string"==typeof r.data?r.data:null;if(!i)throw new Error("Upload succeeded but no svg_map_url returned");const l=`${i}${i.includes("?")?"&":"?"}v=${Date.now()}`;return t(n,{svg_map_url:l}),l}catch(e){const t=Qe(e,{functionName:"useFieldSvgUpload.uploadSvg",service:"pomolobee"});return 401===t.httpStatus||403===t.httpStatus?(t.severity="page",We.emit(t),Promise.reject(t)):Promise.reject(t)}}}}(),{patchField:c}=oa(),[u,d]=(0,o.useState)(!1),[h,m]=(0,o.useState)(null),f=(0,o.useMemo)((()=>{if(!e)return null;if(void 0!==e.orientation)return e;const t=s[e.field_id];return null!=t?t:null}),[e,s]);if(!e)return(0,Je.jsxs)("div",{className:"card p-3",children:[(0,Je.jsx)("h3",{className:"mb-2",children:"Field editor"}),(0,Je.jsx)("div",{className:"text-muted",children:"No field selected."})]});const p=null!==(r=e.name)&&void 0!==r?r:`Field #${e.field_id}`,g=f?.background_image_url||null,[y,b]=(0,o.useState)(null),[v,w]=(0,o.useState)(null),[x,j]=(0,o.useState)(null),[S,N]=(0,o.useState)(!1),[E,R]=(0,o.useState)(null),k=(0,o.useRef)(null),C=null!==(a=null!=v?v:x)&&void 0!==a?a:g;(0,o.useEffect)((()=>()=>{v&&URL.revokeObjectURL(v)}),[v]);const[_,O]=(0,o.useState)(null),T=(0,o.useRef)(null),[A,F]=(0,o.useState)(!1),[P,L]=(0,o.useState)([]),[D,U]=(0,o.useState)(!1),[B,I]=(0,o.useState)(!1),[$,M]=(0,o.useState)(null),W=(0,o.useCallback)((()=>{T.current&&O({w:T.current.naturalWidth,h:T.current.naturalHeight})}),[]),J=(0,o.useRef)(null),q=(0,o.useCallback)(((e,t)=>{if(!J.current||!_)return null;const n=J.current.getBoundingClientRect();if(0===n.width||0===n.height)return null;const r=_.w/n.width,a=_.h/n.height;return{x:(e-n.left)*r,y:(t-n.top)*a}}),[_]),H=(0,o.useCallback)((e=>{if(!A||!_)return;const t=q(e.clientX,e.clientY);t&&L((e=>[...e,t]))}),[A,_,q]),z=(0,o.useCallback)((e=>{A&&(e.preventDefault(),P.length>=3&&(U(!0),F(!1),I(!0)))}),[A,P.length]);(0,o.useEffect)((()=>{const e=e=>{"Escape"===e.key?(F(!1),L([]),U(!1),I(!1)):("Backspace"===e.key||"Delete"===e.key)&&A&&P.length>0&&!D&&(e.preventDefault(),L((e=>e.slice(0,-1))))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[A,D,P.length]);const V=(0,o.useMemo)((()=>P.map((e=>`${e.x.toFixed(2)},${e.y.toFixed(2)}`)).join(" ")),[P]),G=(0,o.useMemo)((()=>_?Math.max(1,Math.round(.002*Math.min(_.w,_.h))):2),[_]),K=()=>{if(!_||!D||P.length<3)return null;const e=`<polygon points="${V}" fill="rgba(0,128,255,0.22)" stroke="rgb(0,128,255)" stroke-width="${G}" />`;return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${_.w} ${_.h}" width="${_.w}" height="${_.h}">${e}</svg>`},Y=D&&P.length>=3,X=Y,Q=A&&!D&&P.length>0,Z=null!=$?$:Y&&B?K():null;return(0,Je.jsxs)("div",{className:"card p-3",children:[(0,Je.jsxs)("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[(0,Je.jsx)("h3",{className:"mb-0",children:p}),(0,Je.jsx)("span",{className:"badge text-bg-secondary",children:"Editor"})]}),(0,Je.jsxs)("div",{className:"mb-3 d-flex gap-2 flex-wrap",children:[(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-dark",onClick:()=>k.current?.click(),title:"Pick a PNG or JPEG to preview as background",children:"Import PNG/JPEG"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-success",onClick:async()=>{if(y)if(f?.field_id||e?.field_id){N(!0),R(null);try{const t=`${f?.short_name||e?.short_name||`field_${f?.field_id||e?.field_id}`}.${"image/png"===y.type?"png":"jpeg"}`;console.log("[FieldEditCard] uploadBackground will be called");const r=await i(f?.field_id||e?.field_id,y,t);v&&URL.revokeObjectURL(v),w(null),b(null),j(r),n?.(r)}catch(e){R(e?.message||"Upload failed.")}finally{console.log("[FieldEditCard] finally"),N(!1)}}else R("Missing field_id.")},disabled:!y||S,title:"Upload the imported image to the backend",children:S?"Saving…":"Save imported PNG"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-primary",onClick:()=>{F(!0),L([]),U(!1),I(!1)},disabled:!C,children:"Select field contour"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>I((e=>!e)),disabled:!Y,"aria-pressed":B,children:"See selected contour"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>{F(!1),L([]),U(!1),I(!1)},disabled:!A&&!D&&0===P.length,children:"Cancel field contour"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-warning",onClick:()=>{A&&!D&&0!==P.length&&L((e=>e.slice(0,-1)))},disabled:!Q,children:"Remove last point"}),(0,Je.jsx)("button",{type:"button",className:"btn btn-sm btn-success",onClick:async()=>{const n=K();n&&(M(n),I(!0),t?.(n),await(async t=>{var n;m(null);const r=f?.field_id||e?.field_id;if(!r)return void m("Missing field_id.");const a=null!==(n=null!=t?t:$)&&void 0!==n?n:K();if(a)try{d(!0);const t=f?.short_name||e?.short_name||`field_${r}`,n=new Blob([a],{type:"image/svg+xml"}),o=new File([n],`${t}_map.svg`,{type:"image/svg+xml"});await l(r,o)}catch(e){m(e?.message||"SVG upload failed.")}finally{d(!1)}else m("No closed contour to save.")})(n))},disabled:!X,title:"Create an SVG from the closed path and show it in the right pane",children:"Save selected contour"}),(0,Je.jsx)("input",{ref:k,type:"file",accept:"image/png,image/jpeg",style:{display:"none"},onChange:e=>{var t;R(null);const n=null!==(t=e.target.files?.[0])&&void 0!==t?t:null;if(!n)return;if(!["image/png","image/jpeg"].includes(n.type))return R("Only PNG or JPEG are allowed."),void(e.target.value="");v&&URL.revokeObjectURL(v);const r=URL.createObjectURL(n);b(n),w(r)}})]}),E&&(0,Je.jsx)("div",{className:"alert alert-warning py-2 my-2",children:E}),C?(0,Je.jsxs)("div",{className:"row g-3 align-items-stretch",children:[(0,Je.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,Je.jsxs)("div",{className:"border rounded overflow-hidden position-relative",style:{background:"#f8f9fa",minHeight:300},children:[(0,Je.jsx)("img",{ref:T,src:C||"",onError:e=>{e.currentTarget.onerror=null,e.currentTarget.src="/static/fallback.png"},alt:"Field background",className:"w-100",style:{display:"block",objectFit:"contain"},onLoad:W}),(0,Je.jsx)("div",{ref:J,className:"position-absolute top-0 start-0 w-100 h-100",onClick:H,onDoubleClick:z,role:"application","aria-label":"Field contour editor",style:{cursor:A?"crosshair":"default"},children:_&&(0,Je.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${_.w} ${_.h}`,preserveAspectRatio:"xMidYMid meet",className:"w-100 h-100",children:[P.length>0&&!D&&(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("polyline",{points:V,fill:"none",stroke:"rgb(0,128,255)",strokeWidth:G}),P.map(((e,t)=>(0,Je.jsx)("circle",{cx:e.x,cy:e.y,r:Math.max(3,1.5*G),fill:"white",stroke:"rgb(0,128,255)",strokeWidth:Math.max(1,.75*G)},t)))]}),D&&P.length>=3&&(0,Je.jsx)("polygon",{points:V,fill:"rgba(0,128,255,0.22)",stroke:"rgb(0,128,255)",strokeWidth:G})]})})]}),(0,Je.jsx)("div",{className:"small text-muted mt-2",children:"Click to add vertices. Double-click to close. ESC cancels. Backspace/Delete removes last point while drawing."})]}),(0,Je.jsxs)("div",{className:"col-12 col-lg-6",children:[(0,Je.jsxs)("div",{className:"border rounded overflow-hidden position-relative",style:{background:"#f8f9fa",minHeight:300},"aria-label":"Result overlay",children:[(0,Je.jsx)("img",{src:C,alt:"Field background (result)",className:"w-100",style:{display:"block",objectFit:"contain"}}),_&&Z&&(0,Je.jsx)("div",{className:"position-absolute top-0 start-0 w-100 h-100",style:{pointerEvents:"none"},children:(0,Je.jsx)("object",{type:"image/svg+xml",data:`data:image/svg+xml;utf8,${encodeURIComponent(Z)}`,className:"w-100 h-100","aria-label":"Selected contour overlay"})})]}),$&&(0,Je.jsxs)("details",{className:"mt-2",children:[(0,Je.jsx)("summary",{children:"Show saved SVG markup"}),(0,Je.jsx)("pre",{className:"small",style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:$})]})]})]}):(0,Je.jsx)("div",{className:"text-muted",children:"No background image yet. Import one to begin."})]})},ka=()=>{console.log("[FarmMgt] component called"),ta((()=>reset()));const{activeField:e}=oa();return(0,Je.jsxs)(Je.Fragment,{children:[(0,Je.jsx)("h1",{children:"Farm Management"}),(0,Je.jsx)(wa,{}),(0,Je.jsx)(ya,{}),(0,Je.jsx)(Ra,{field:e})]})},Ca=()=>(0,Je.jsxs)(Je.Fragment,{children:["  ",(0,Je.jsx)(wt,{}),(0,Je.jsx)(ka,{})]});function _a(){return(0,Je.jsxs)(ue,{children:[(0,Je.jsx)(le,{path:"/home",element:(0,Je.jsx)(la,{})}),(0,Je.jsx)(le,{path:"/login",element:(0,Je.jsx)(na,{plugin:"pomolobee",initialDemoRoles:["farmer"],usePluginBootstrap:pa,usePluginApis:()=>({apiUser:da})})}),(0,Je.jsx)(le,{path:"/user_mgt",element:(0,Je.jsx)(Hr,{plugin:"pomolobee"})}),(0,Je.jsx)(le,{path:"/login",element:(0,Je.jsx)(ga,{})}),(0,Je.jsx)(le,{path:"/error",element:(0,Je.jsx)(et,{plugin:"pomolobee"})}),(0,Je.jsx)(le,{path:"/errormgt",element:(0,Je.jsx)(Ea,{})}),(0,Je.jsx)(le,{path:"/dashboard",element:(0,Je.jsx)(va,{})}),(0,Je.jsx)(le,{path:"/farm",element:(0,Je.jsx)(Na,{})}),(0,Je.jsx)(le,{path:"/farmmgt",element:(0,Je.jsx)(Ca,{})}),(0,Je.jsx)(le,{path:"/",element:(0,Je.jsx)(la,{})})]})}function Oa(){const{isLoggedIn:e,user:t}=vt();return(0,o.useEffect)((()=>{Ke=()=>{var n,r,a;const o=null!==(n=null!==(r=t?.roles)&&void 0!==r?r:t?.capabilities)&&void 0!==n?n:Array.isArray(t?.role)?t.role:void 0;return{isLoggedIn:!!e,id:null!==(a=t?.id)&&void 0!==a?a:t?.ID,username:t?.username||t?.name||t?.user_login,email:t?.email,roles:Array.isArray(o)?o:o?Object.keys(o):[]}}}),[e,t]),null}const Ta=()=>{const[e,t]=(0,o.useState)((()=>window.innerWidth>=768)),n=function(){const e=window?.pomolobeeSettings?.basename;if(e)return e;const t=location.pathname.split("/").filter(Boolean)[0]||"";return t?`/${t}`:"/"}(),r=window?.pomolobeeSettings?.errorPath||"/error";return(0,o.useEffect)((()=>{const e=e=>{We.emit(Qe(e.error||e.message,{component:"window",functionName:"error",service:"runtime",severity:"toast"}))},t=e=>{We.emit(Qe(e.reason,{component:"window",functionName:"unhandledrejection",service:"runtime",severity:"toast"}))};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",t),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",t)}}),[]),(0,Je.jsx)("div",{className:"pomolobee-app-container",children:(0,Je.jsxs)(Fe,{basename:n,children:[(0,Je.jsx)(ft,{className:"translate-box",style:{padding:10,textAlign:"right"},languages:"fr,en",pageLanguage:"en",containerId:"pb_google_translate"}),(0,Je.jsxs)("div",{className:"app-layout",children:[(0,Je.jsxs)("div",{className:"sidebar "+(e?"open":""),children:[(0,Je.jsx)("button",{className:"hamburger-icon",onClick:()=>t(!e),children:"☰"}),(0,Je.jsx)(sa,{})]}),(0,Je.jsx)("div",{className:"content-container",children:(0,Je.jsxs)(He,{errorPath:r,children:[(0,Je.jsx)(Oa,{}),(0,Je.jsx)(Ge,{}),(0,Je.jsx)(Ze,{children:(0,Je.jsx)(_a,{})})]})})]})]})})};document.querySelectorAll(".wp-block-pomolobee-pomolobee-app").forEach((e=>{(0,a.createRoot)(e).render((0,Je.jsx)(bt,{children:(0,Je.jsx)(aa,{children:(0,Je.jsx)(Ta,{})})}))}))}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.m=t,e=[],r.O=(t,n,a,o)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,a,o]=e[u],i=!0,l=0;l<n.length;l++)(!1&o||s>=o)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(i=!1,o<s&&(s=o));if(i){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={521:0,221:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,[s,i,l]=n,c=0;if(s.some((t=>0!==e[t]))){for(a in i)r.o(i,a)&&(r.m[a]=i[a]);if(l)var u=l(r)}for(t&&t(n);c<s.length;c++)o=s[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(u)},n=globalThis.webpackChunk=globalThis.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=r.O(void 0,[221],(()=>r(665)));a=r.O(a)})();